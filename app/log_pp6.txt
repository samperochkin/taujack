
R version 4.2.1 (2022-06-23) -- "Funny-Looking Kid"
Copyright (C) 2022 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> # Preprocessing of the raw data
> # launched with 
> # R CMD BATCH --vanilla --no-restore app/preprocessing.R app/log_pp.txt
> 
> # packages ----------------------------------------------------------------
> library(tidyverse)
── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──
✔ ggplot2 3.3.6     ✔ purrr   0.3.4
✔ tibble  3.1.8     ✔ dplyr   1.1.0
✔ tidyr   1.2.1     ✔ stringr 1.4.1
✔ readr   2.1.2     ✔ forcats 0.5.2
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
> library(lubridate)

Attaching package: ‘lubridate’

The following objects are masked from ‘package:base’:

    date, intersect, setdiff, union

> library(lunar)
> library(ggplot2)
> library(spatstat.geom) # weighted ecdf
Loading required package: spatstat.data
spatstat.geom 3.2-4
> 
> 
> 
> # load and preprocess data ------------------------------------------------
> stns_id <- readRDS("app/data/stns_id.rds")
> weathercan::stations() %>% filter(station_id %in% stns_id, interval == "day") %>%
+   print(nrow = nrow(.))
The stations data frame hasn't been updated in over 4 weeks. Consider running `stations_dl()` to check for updates and make sure you have the most recent stations list available
# A tibble: 8 × 16
  prov  station…¹ stati…² clima…³ WMO_id TC_id   lat    lon   elev tz    inter…⁴
  <chr> <chr>       <dbl> <chr>    <dbl> <chr> <dbl>  <dbl>  <dbl> <chr> <chr>  
1 BC    QUATSINO      271 1036570     NA <NA>   50.5 -128.  3.42e0 Etc/… day    
2 BC    BARKERVI…     568 1090660     NA <NA>   53.1 -122.  1.28e3 Etc/… day    
3 BC    AGASSIZ …     707 1100120     NA <NA>   49.2 -122.  1.5 e1 Etc/… day    
4 ON    OTTAWA C…    4333 6105976     NA WCG    45.4  -75.7 7.92e1 Etc/… day    
5 ON    WELLAND      4712 6139445     NA <NA>   43.0  -79.3 1.75e2 Etc/… day    
6 ON    BELLEVIL…    4859 6150689     NA <NA>   44.2  -77.4 7.62e1 Etc/… day    
7 ON    BLOOMFIE…    4862 6150815     NA <NA>   44.0  -77.2 9.14e1 Etc/… day    
8 ON    TORONTO      5051 6158350  71266 <NA>   43.7  -79.4 1.12e2 Etc/… day    
# … with 5 more variables: start <dbl>, end <dbl>, normals <lgl>,
#   normals_1981_2010 <lgl>, normals_1971_2000 <lgl>, and abbreviated variable
#   names ¹​station_name, ²​station_id, ³​climate_id, ⁴​interval
> 
> filepaths <- paste0("app/data/daily_data_", stns_id, ".rds")
> data <- lapply(filepaths, readRDS) |> dplyr::bind_rows()
> str(data)
tibble [421,408 × 37] (S3: tbl_df/tbl/data.frame)
 $ station_name      : chr [1:421408] "QUATSINO" "QUATSINO" "QUATSINO" "QUATSINO" ...
 $ station_id        : num [1:421408] 271 271 271 271 271 271 271 271 271 271 ...
 $ station_operator  : logi [1:421408] NA NA NA NA NA NA ...
 $ prov              : chr [1:421408] "BC" "BC" "BC" "BC" ...
 $ lat               : num [1:421408] 50.5 50.5 50.5 50.5 50.5 ...
 $ lon               : num [1:421408] -128 -128 -128 -128 -128 ...
 $ elev              : num [1:421408] 3.4 3.4 3.4 3.4 3.4 3.4 3.4 3.4 3.4 3.4 ...
 $ climate_id        : chr [1:421408] "1036570" "1036570" "1036570" "1036570" ...
 $ WMO_id            : chr [1:421408] NA NA NA NA ...
 $ TC_id             : chr [1:421408] NA NA NA NA ...
 $ date              : Date[1:421408], format: "1895-01-01" "1895-01-02" ...
 $ year              : chr [1:421408] "1895" "1895" "1895" "1895" ...
 $ month             : chr [1:421408] "01" "01" "01" "01" ...
 $ day               : chr [1:421408] "01" "02" "03" "04" ...
 $ qual              : chr [1:421408] NA NA NA NA ...
 $ cool_deg_days     : num [1:421408] NA NA NA NA NA NA NA NA NA NA ...
 $ cool_deg_days_flag: chr [1:421408] NA NA NA NA ...
 $ dir_max_gust      : num [1:421408] NA NA NA NA NA NA NA NA NA NA ...
 $ dir_max_gust_flag : chr [1:421408] NA NA NA NA ...
 $ heat_deg_days     : num [1:421408] NA NA NA NA NA NA NA NA NA NA ...
 $ heat_deg_days_flag: chr [1:421408] NA NA NA NA ...
 $ max_temp          : num [1:421408] NA NA NA NA NA NA NA NA NA NA ...
 $ max_temp_flag     : chr [1:421408] NA NA NA NA ...
 $ mean_temp         : num [1:421408] NA NA NA NA NA NA NA NA NA NA ...
 $ mean_temp_flag    : chr [1:421408] NA NA NA NA ...
 $ min_temp          : num [1:421408] NA NA NA NA NA NA NA NA NA NA ...
 $ min_temp_flag     : chr [1:421408] NA NA NA NA ...
 $ snow_grnd         : num [1:421408] NA NA NA NA NA NA NA NA NA NA ...
 $ snow_grnd_flag    : chr [1:421408] NA NA NA NA ...
 $ spd_max_gust      : num [1:421408] NA NA NA NA NA NA NA NA NA NA ...
 $ spd_max_gust_flag : chr [1:421408] NA NA NA NA ...
 $ total_precip      : num [1:421408] NA NA NA NA NA NA NA NA NA NA ...
 $ total_precip_flag : chr [1:421408] NA NA NA NA ...
 $ total_rain        : num [1:421408] NA NA NA NA NA NA NA NA NA NA ...
 $ total_rain_flag   : chr [1:421408] NA NA NA NA ...
 $ total_snow        : num [1:421408] NA NA NA NA NA NA NA NA NA NA ...
 $ total_snow_flag   : chr [1:421408] NA NA NA NA ...
> 
> # time variables setup
> data <- data %>% mutate(date = as.Date(date),
+                         year = as.integer(year),
+                         month = as.integer(month),
+                         day = as.integer(day))
> 
> data <- data %>% mutate(time = as.integer(date),
+                         yday = lubridate::yday(date),
+                         week = lubridate::week(date))
> 
> # stations we look at
> stns_id <- c(568, 4333, 5051)
> p <- 3
> data <- data %>%
+   filter(station_id %in% stns_id) %>%
+   arrange(station_id, date)
> 
> # quick look at summary of the data (clearly shows time trends)
> data0 <- data %>% group_by(station_name, year) %>%
+   summarise(mm_temp = mean(mean_temp, na.rm=T))
`summarise()` has grouped output by 'station_name'. You can override using the
`.groups` argument.
> ggplot(data0, aes(x=year, y=mm_temp)) +
+   geom_line() +
+   geom_point() +
+   facet_wrap(~station_name)
Warning messages:
1: Removed 20 row(s) containing missing values (geom_path). 
2: Removed 25 rows containing missing values (geom_point). 
> 
> 
> # Estimate mean conditional on time of year -------------------------------
> year_len <- 365 + 6/24 + 9/60/24 + 9/60^2/24
> 
> # create sines-cosines basis (for seasonal trend)
> # nSC <- 24
> # s_cols <- paste0("s", 1:nSC)
> # c_cols <- paste0("c", 1:nSC)
> # for (i in 1:nSC) data <- data %>%
> #   mutate(!!s_cols[i] := sin(i*2*pi*time/year_len),
> #          !!c_cols[i] := cos(i*2*pi*time/year_len))
> ffreq <- c(1,2,4,6,8,10,12)
> nSC <- length(ffreq)
> s_cols <- paste0("s", ffreq)
> c_cols <- paste0("c", ffreq)
> for (i in 1:nSC) data <- data %>%
+   mutate(!!s_cols[i] := sin(i*2*pi*time/year_len),
+          !!c_cols[i] := cos(i*2*pi*time/year_len))
> 
> 
> # create natural spline basis (for long term time trend)
> # for this check range for each station
> row_ids <- sapply(stns_id, \(id) data$station_id == id)
> bss <- lapply(1:p, \(k){
+   data[row_ids[,k],] %>% filter(day == 21, month %in% c(6,12)) %>% select(time) %>% unlist
+ })
> 
> for(b in paste("b", 1:max(sapply(bss, length)))) data <- data %>% mutate(!!b := NA)
> nB <- rep(0, p); b_cols <- list()
> for(k in 1:p){
+   B <- splines::bs(data[row_ids[,k],]$time, knots = c(bss[[k]]), degree = 2)
+   B <- B[,colSums(abs(B[!is.na(data[row_ids[,k],]$mean_temp),])) > 1e-5]
+   nB[k] <- ncol(B)
+   b_cols[[length(b_cols)+1]] <- paste0("b", 1:nB[k])
+   data[row_ids[,k],b_cols[[k]]] <- B
+   rm(B)
+ }
> 
> 
> # fit least-squares
> non_na <- !is.na(data$mean_temp) # for later
> lms <- lapply(1:p, \(k){
+   x_cols <- c("mean_temp", s_cols, c_cols, b_cols[[k]])
+   lm(formula = "mean_temp~.", data = data[row_ids[,k],x_cols])
+ })
> 
> # Bakerville
> summary(lms[[1]])

Call:
lm(formula = "mean_temp~.", data = data[row_ids[, k], x_cols])

Residuals:
    Min      1Q  Median      3Q     Max 
-31.732  -2.441   0.256   2.982  18.683 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)   8.97964    2.11317   4.249 2.15e-05 ***
s1           -8.31016    3.73656  -2.224  0.02615 *  
s2            0.57175    0.03171  18.033  < 2e-16 ***
s4           -0.09727    0.12254  -0.794  0.42735    
s6            0.23294    0.03148   7.399 1.39e-13 ***
s8           -0.20722    0.03603  -5.751 8.95e-09 ***
s10          -0.09528    0.03146  -3.028  0.00246 ** 
s12          -0.07521    0.03156  -2.383  0.01718 *  
c1          -11.22108    0.72274 -15.526  < 2e-16 ***
c2           -0.31753    0.03168 -10.022  < 2e-16 ***
c4           -0.13248    0.08268  -1.602  0.10907    
c6           -0.11762    0.03151  -3.733  0.00019 ***
c8            0.11687    0.04009   2.915  0.00356 ** 
c10          -0.12738    0.03145  -4.050 5.13e-05 ***
c12          -0.07923    0.03325  -2.382  0.01720 *  
b1            1.80808    6.12849   0.295  0.76797    
b2          -14.62981    8.57406  -1.706  0.08796 .  
b3            4.21402    6.52287   0.646  0.51826    
b4          -15.71269    8.69288  -1.808  0.07069 .  
b5            1.35754    6.51934   0.208  0.83505    
b6          -14.89484    8.70198  -1.712  0.08697 .  
b7            1.52623    6.52901   0.234  0.81517    
b8          -15.05787    8.69791  -1.731  0.08342 .  
b9            1.80796    6.53393   0.277  0.78201    
b10         -15.53627    8.68998  -1.788  0.07381 .  
b11           1.57692    6.53485   0.241  0.80932    
b12         -16.88665    8.72991  -1.934  0.05308 .  
b13           2.61460    6.52597   0.401  0.68868    
b14         -15.98374    8.70833  -1.835  0.06645 .  
b15           3.30396    6.52792   0.506  0.61277    
b16         -16.55175    8.69236  -1.904  0.05689 .  
b17           2.88406    6.51758   0.443  0.65813    
b18         -17.23514    8.69265  -1.983  0.04740 *  
b19           3.34948    6.53061   0.513  0.60803    
b20         -15.91701    8.71648  -1.826  0.06784 .  
b21           4.17880    6.54277   0.639  0.52303    
b22         -15.05400    8.71198  -1.728  0.08400 .  
b23          -0.37429    6.53847  -0.057  0.95435    
b24         -15.92074    8.71919  -1.826  0.06787 .  
b25           6.47707    6.54210   0.990  0.32215    
b26         -18.10893    8.72099  -2.076  0.03786 *  
b27           3.31159    6.54276   0.506  0.61276    
b28         -15.91563    8.72079  -1.825  0.06800 .  
b29           4.76696    6.54136   0.729  0.46616    
b30         -18.62988    8.71693  -2.137  0.03259 *  
b31           3.33064    6.53223   0.510  0.61014    
b32         -17.77757    8.69502  -2.045  0.04090 *  
b33           1.97430    6.51956   0.303  0.76202    
b34         -15.83211    8.69479  -1.821  0.06863 .  
b35           5.63944    6.53177   0.863  0.38793    
b36         -18.95741    8.71599  -2.175  0.02963 *  
b37           6.41798    6.53943   0.981  0.32639    
b38         -17.85675    8.71633  -2.049  0.04050 *  
b39          -0.70033    6.54286  -0.107  0.91476    
b40         -14.34125    8.69631  -1.649  0.09913 .  
b41           1.76203    6.52009   0.270  0.78697    
b42         -16.11704    8.69486  -1.854  0.06380 .  
b43           1.74250    6.53182   0.267  0.78965    
b44         -19.97738    8.71599  -2.292  0.02191 *  
b45           3.69189    6.53935   0.565  0.57237    
b46         -19.34144    8.71604  -2.219  0.02649 *  
b47           2.45093    6.53186   0.375  0.70749    
b48         -19.61960    8.69486  -2.256  0.02405 *  
b49           4.56427    6.51951   0.700  0.48387    
b50         -18.38198    8.69479  -2.114  0.03451 *  
b51           1.41088    6.53178   0.216  0.82899    
b52         -17.91426    8.71599  -2.055  0.03985 *  
b53           4.90081    6.53934   0.749  0.45360    
b54         -19.61982    8.71605  -2.251  0.02439 *  
b55           7.61298    6.53186   1.166  0.24382    
b56         -19.32129    8.69487  -2.222  0.02628 *  
b57           0.49255    6.51951   0.076  0.93978    
b58         -17.19875    8.69480  -1.978  0.04793 *  
b59          -0.73106    6.53179  -0.112  0.91089    
b60         -16.11011    8.71600  -1.848  0.06456 .  
b61           2.08220    6.53935   0.318  0.75018    
b62         -16.08969    8.71605  -1.846  0.06490 .  
b63           2.66744    6.53186   0.408  0.68300    
b64         -19.36805    8.69487  -2.228  0.02592 *  
b65           2.15913    6.51952   0.331  0.74051    
b66         -18.15403    8.69482  -2.088  0.03681 *  
b67           3.99381    6.53180   0.611  0.54091    
b68         -19.16579    8.71601  -2.199  0.02789 *  
b69           0.70165    6.53935   0.107  0.91455    
b70         -16.21163    8.71605  -1.860  0.06290 .  
b71           1.88627    6.53185   0.289  0.77275    
b72         -15.34719    8.69487  -1.765  0.07756 .  
b73           4.22645    6.51952   0.648  0.51681    
b74         -18.85704    8.69483  -2.169  0.03011 *  
b75           4.14946    6.53181   0.635  0.52526    
b76         -18.27440    8.71602  -2.097  0.03603 *  
b77           8.27194    6.53936   1.265  0.20590    
b78         -20.01434    8.71605  -2.296  0.02167 *  
b79           4.28252    6.53185   0.656  0.51206    
b80         -19.45253    8.69488  -2.237  0.02528 *  
b81           3.71262    6.51957   0.569  0.56905    
b82         -16.67724    8.69495  -1.918  0.05511 .  
b83           1.33835    6.53220   0.205  0.83766    
b84         -16.95176    8.71600  -1.945  0.05179 .  
b85           1.20551    6.53934   0.184  0.85374    
b86         -16.18710    8.71604  -1.857  0.06329 .  
b87           6.05838    6.53184   0.928  0.35366    
b88         -18.99565    8.69486  -2.185  0.02892 *  
b89           2.91549    6.51953   0.447  0.65474    
b90         -17.29465    8.69485  -1.989  0.04670 *  
b91           4.49606    6.53185   0.688  0.49125    
b92         -21.61627    8.71607  -2.480  0.01314 *  
b93           7.52217    6.53943   1.150  0.25004    
b94         -20.45317    8.71623  -2.347  0.01895 *  
b95           1.12190    6.53226   0.172  0.86364    
b96         -16.85718    8.69604  -1.938  0.05257 .  
b97           0.02665    6.52263   0.004  0.99674    
b98         -16.99275    8.69406  -1.955  0.05065 .  
b99          -0.09441    6.53143  -0.014  0.98847    
b100        -14.74437    8.71577  -1.692  0.09071 .  
b101          3.40965    6.53925   0.521  0.60208    
b102        -16.13906    8.71598  -1.852  0.06408 .  
b103          2.26487    6.53181   0.347  0.72878    
b104        -16.50726    8.69484  -1.899  0.05763 .  
b105          5.09609    6.51952   0.782  0.43442    
b106        -19.51114    8.69486  -2.244  0.02484 *  
b107          7.80452    6.53185   1.195  0.23216    
b108        -19.46192    8.71605  -2.233  0.02556 *  
b109          3.38301    6.53936   0.517  0.60493    
b110        -17.62055    8.71603  -2.022  0.04322 *  
b111         -0.59763    6.53182  -0.091  0.92710    
b112        -16.31401    8.69484  -1.876  0.06062 .  
b113          3.45512    6.51953   0.530  0.59614    
b114        -16.51596    8.69487  -1.900  0.05750 .  
b115          3.42288    6.53187   0.524  0.60026    
b116        -20.72762    8.71611  -2.378  0.01741 *  
b117          5.19609    6.53948   0.795  0.42687    
b118        -21.10649    8.71635  -2.421  0.01546 *  
b119          5.45712    6.53254   0.835  0.40351    
b120        -18.21893    8.69691  -2.095  0.03619 *  
b121          3.13895    6.52603   0.481  0.63053    
b122        -15.62041    8.71778  -1.792  0.07317 .  
b123         -7.52207    6.77450  -1.110  0.26685    
b124         28.06537   89.97511   0.312  0.75510    
b125        -50.56546   28.21439  -1.792  0.07311 .  
b126        -18.55625    8.84407  -2.098  0.03590 *  
b127          0.63918    6.55153   0.098  0.92228    
b128        -14.58633    8.70412  -1.676  0.09379 .  
b129          1.65252    6.53552   0.253  0.80038    
b130        -14.88626    8.71744  -1.708  0.08771 .  
b131         -1.01439    6.53995  -0.155  0.87674    
b132        -15.87171    8.71625  -1.821  0.06862 .  
b133          1.77349    6.53189   0.272  0.78600    
b134        -20.76044    8.69485  -2.388  0.01696 *  
b135          1.13079    6.51953   0.173  0.86230    
b136        -17.75508    8.69488  -2.042  0.04116 *  
b137          0.86434    6.53186   0.132  0.89473    
b138        -17.71497    8.71605  -2.032  0.04211 *  
b139          6.90015    6.53934   1.055  0.29135    
b140        -18.01143    8.71600  -2.066  0.03879 *  
b141          3.07849    6.53177   0.471  0.63742    
b142        -19.41516    8.69479  -2.233  0.02556 *  
b143          3.00647    6.51950   0.461  0.64469    
b144        -18.16597    8.69487  -2.089  0.03669 *  
b145          5.97808    6.53186   0.915  0.36008    
b146        -18.47977    8.71604  -2.120  0.03399 *  
b147          0.49650    6.53933   0.076  0.93948    
b148        -15.52980    8.71599  -1.782  0.07480 .  
b149          3.22257    6.53176   0.493  0.62175    
b150        -16.68428    8.69481  -1.919  0.05501 .  
b151          2.58456    6.51959   0.396  0.69179    
b152        -19.65938    8.69516  -2.261  0.02377 *  
b153          0.92750    6.53531   0.142  0.88714    
b154        -16.72461    8.71649  -1.919  0.05502 .  
b155          1.30211    6.53961   0.199  0.84218    
b156        -16.74395    8.71601  -1.921  0.05473 .  
b157          1.82740    6.53175   0.280  0.77965    
b158        -16.61717    8.69477  -1.911  0.05599 .  
b159          4.38022    6.51948   0.672  0.50167    
b160        -20.80077    8.69486  -2.392  0.01675 *  
b161          1.65054    6.53185   0.253  0.80051    
b162        -16.05893    8.71603  -1.842  0.06541 .  
b163          4.10791    6.53931   0.628  0.52988    
b164        -19.52824    8.71595  -2.241  0.02506 *  
b165          3.28217    6.53171   0.502  0.61532    
b166        -18.70498    8.69474  -2.151  0.03146 *  
b167          0.67161    6.51947   0.103  0.91795    
b168        -18.93164    8.69485  -2.177  0.02946 *  
b169          3.64382    6.53184   0.558  0.57695    
b170        -19.35180    8.71601  -2.220  0.02641 *  
b171          1.80308    6.53927   0.276  0.78276    
b172        -16.13814    8.71588  -1.852  0.06409 .  
b173         -0.34468    6.53155  -0.053  0.95791    
b174        -16.43243    8.69446  -1.890  0.05877 .  
b175          3.59404    6.51905   0.551  0.58142    
b176        -17.06071    8.69354  -1.962  0.04972 *  
b177          6.38081    6.52877   0.977  0.32841    
b178        -20.35044    8.70928  -2.337  0.01946 *  
b179          2.38108    6.52766   0.365  0.71529    
b180        -13.28464    8.70636  -1.526  0.12705    
b181          1.43923    6.64547   0.217  0.82854    
b182        -15.07122    8.72456  -1.727  0.08409 .  
b183          2.89331    6.53141   0.443  0.65778    
b184        -16.73403    8.69951  -1.924  0.05442 .  
b185          5.30905    6.53383   0.813  0.41648    
b186        -16.83666    8.71680  -1.932  0.05343 .  
b187          1.00223    6.53958   0.153  0.87820    
b188        -17.29121    8.71764  -1.983  0.04732 *  
b189          6.37212    6.53169   0.976  0.32928    
b190        -19.80709    8.69385  -2.278  0.02271 *  
b191          5.70830    6.51941   0.876  0.38126    
b192        -21.24861    8.69486  -2.444  0.01454 *  
b193          4.36068    6.53233   0.668  0.50442    
b194        -20.57378    8.71957  -2.359  0.01830 *  
b195          4.06010    6.53934   0.621  0.53469    
b196        -18.17029    8.71586  -2.085  0.03710 *  
b197          6.49230    6.53161   0.994  0.32024    
b198        -17.40209    8.69466  -2.001  0.04535 *  
b199          3.78353    6.51950   0.580  0.56169    
b200        -17.08761    8.69568  -1.965  0.04941 *  
b201          1.70969    6.53190   0.262  0.79352    
b202        -16.15690    8.71598  -1.854  0.06379 .  
b203          4.25056    6.53922   0.650  0.51569    
b204        -18.41638    8.71588  -2.113  0.03461 *  
b205          3.11967    6.53160   0.478  0.63292    
b206        -17.87451    8.69487  -2.056  0.03981 *  
b207          8.67646    6.51944   1.331  0.18324    
b208        -20.22823    8.69477  -2.326  0.02000 *  
b209          3.51848    6.53168   0.539  0.59011    
b210        -17.16873    8.71565  -1.970  0.04886 *  
b211          5.20420    6.53851   0.796  0.42608    
b212        -17.99859    8.71420  -2.065  0.03889 *  
b213          4.26765    6.52834   0.654  0.51330    
b214        -17.79309    8.68853  -2.048  0.04058 *  
b215          0.85394    6.53413   0.131  0.89602    
b216        -19.17541    8.69066  -2.206  0.02736 *  
b217          2.31996    6.52992   0.355  0.72238    
b218        -17.38837    8.71492  -1.995  0.04602 *  
b219          5.81630    6.53900   0.889  0.37375    
b220        -16.39532    8.71562  -1.881  0.05996 .  
b221          2.78743    6.53145   0.427  0.66955    
b222        -17.24905    8.69479  -1.984  0.04728 *  
b223          3.42357    6.51951   0.525  0.59950    
b224        -17.88163    8.69478  -2.057  0.03973 *  
b225          2.65103    6.53192   0.406  0.68485    
b226        -16.59442    8.71592  -1.904  0.05693 .  
b227          0.63117    6.53909   0.097  0.92311    
b228        -16.62647    8.71595  -1.908  0.05645 .  
b229          5.34590    6.53134   0.818  0.41308    
b230        -19.27187    8.69402  -2.217  0.02665 *  
b231          5.55611    6.51838   0.852  0.39401    
b232        -18.44228    8.69368  -2.121  0.03390 *  
b233          5.31418    6.53436   0.813  0.41607    
b234        -18.57307    8.71629  -2.131  0.03311 *  
b235          5.15770    6.53781   0.789  0.43017    
b236        -17.93229    8.71196  -2.058  0.03956 *  
b237          4.45390    6.52475   0.683  0.49485    
b238        -17.60989    8.69661  -2.025  0.04288 *  
b239          1.44656    6.52975   0.222  0.82468    
b240        -16.71299    8.69995  -1.921  0.05473 .  
b241         -0.49504    6.53004  -0.076  0.93957    
b242        -12.81778    8.72281  -1.469  0.14172    
b243          5.20890    6.53590   0.797  0.42547    
b244        -19.14236    8.71164  -2.197  0.02800 *  
b245          0.85714    6.55814   0.131  0.89601    
b246        -17.38179    8.71552  -1.994  0.04612 *  
b247          2.63927    6.54109   0.403  0.68659    
b248        -16.05415    8.69951  -1.845  0.06498 .  
b249          3.17076    6.53759   0.485  0.62768    
b250        -15.30293    8.71462  -1.756  0.07909 .  
b251          1.02643    6.52086   0.157  0.87492    
b252        -15.82168    8.69944  -1.819  0.06896 .  
b253          6.38038    6.53050   0.977  0.32857    
b254          5.65305   14.50060   0.390  0.69665    
b255        -29.72824   21.00808  -1.415  0.15705    
b256        -15.27558    8.86933  -1.722  0.08502 .  
b257          2.83448    6.57334   0.431  0.66632    
b258        -15.89542    8.72487  -1.822  0.06848 .  
b259          0.80340    6.53336   0.123  0.90213    
b260        -14.78217    8.68994  -1.701  0.08894 .  
b261          0.09189    6.48154   0.014  0.98869    
b262         -4.02268    3.35589  -1.199  0.23065    
b263          5.51713   87.44298   0.063  0.94969    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 4.708 on 44641 degrees of freedom
  (4601 observations deleted due to missingness)
Multiple R-squared:  0.7264,	Adjusted R-squared:  0.7247 
F-statistic: 427.8 on 277 and 44641 DF,  p-value: < 2.2e-16

> # Ottawa
> summary(lms[[2]])

Call:
lm(formula = "mean_temp~.", data = data[row_ids[, k], x_cols])

Residuals:
     Min       1Q   Median       3Q      Max 
-21.7366  -3.0120  -0.0274   3.0411  18.4037 

Coefficients: (1 not defined because of singularities)
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)   3.40563    8.46189   0.402  0.68734    
s1          -33.17519    3.72349  -8.910  < 2e-16 ***
s2           -1.04871    0.03032 -34.592  < 2e-16 ***
s4           -1.22418    0.12152 -10.074  < 2e-16 ***
s6            0.16238    0.03026   5.366 8.08e-08 ***
s8            0.02998    0.03492   0.858  0.39069    
s10           0.09160    0.03027   3.026  0.00248 ** 
s12           0.06767    0.03037   2.228  0.02586 *  
c1          -20.34506    0.72406 -28.099  < 2e-16 ***
c2           -0.74926    0.03043 -24.625  < 2e-16 ***
c4           -0.63173    0.08223  -7.683 1.59e-14 ***
c6           -0.05050    0.03029  -1.668  0.09542 .  
c8           -0.24397    0.03908  -6.243 4.33e-10 ***
c10           0.16974    0.03026   5.610 2.03e-08 ***
c12           0.02044    0.03211   0.637  0.52435    
b1          -93.10818   55.83299  -1.668  0.09540 .  
b2          -44.33107    9.27649  -4.779 1.77e-06 ***
b3           54.48370   12.75152   4.273 1.93e-05 ***
b4          -52.86170    9.30913  -5.678 1.37e-08 ***
b5           55.49328   12.82107   4.328 1.51e-05 ***
b6          -50.72705    9.31940  -5.443 5.26e-08 ***
b7           56.27162   12.82566   4.387 1.15e-05 ***
b8          -52.60460    9.32326  -5.642 1.69e-08 ***
b9           54.17094   12.83812   4.220 2.45e-05 ***
b10         -52.38199    9.33502  -5.611 2.02e-08 ***
b11          57.33067   12.84508   4.463 8.09e-06 ***
b12         -52.48193    9.33544  -5.622 1.90e-08 ***
b13          56.83189   12.83943   4.426 9.60e-06 ***
b14         -52.89469    9.32463  -5.673 1.41e-08 ***
b15          56.50654   12.82928   4.404 1.06e-05 ***
b16         -52.48092    9.32448  -5.628 1.83e-08 ***
b17          57.55024   12.83955   4.482 7.40e-06 ***
b18         -53.39993    9.33639  -5.720 1.07e-08 ***
b19          59.05033   12.84922   4.596 4.33e-06 ***
b20         -51.74328    9.34211  -5.539 3.06e-08 ***
b21          55.76547   12.86214   4.336 1.46e-05 ***
b22         -51.10813    9.33842  -5.473 4.45e-08 ***
b23          56.34167   12.84897   4.385 1.16e-05 ***
b24         -51.11930    9.33886  -5.474 4.43e-08 ***
b25          56.90802   12.84941   4.429 9.49e-06 ***
b26         -52.24354    9.33876  -5.594 2.23e-08 ***
b27          58.56297   12.84828   4.558 5.18e-06 ***
b28         -54.69146    9.33678  -5.858 4.73e-09 ***
b29          60.30473   12.84090   4.696 2.66e-06 ***
b30         -55.17522    9.32548  -5.917 3.31e-09 ***
b31          55.25091   12.83061   4.306 1.66e-05 ***
b32         -53.77884    9.32535  -5.767 8.12e-09 ***
b33          54.08725   12.84048   4.212 2.53e-05 ***
b34         -51.69560    9.33627  -5.537 3.09e-08 ***
b35          57.06205   12.84663   4.442 8.94e-06 ***
b36         -51.69418    9.33632  -5.537 3.09e-08 ***
b37          53.49974   12.84060   4.166 3.10e-05 ***
b38         -52.46863    9.32540  -5.626 1.85e-08 ***
b39          55.14347   12.83057   4.298 1.73e-05 ***
b40         -50.14568    9.32534  -5.377 7.59e-08 ***
b41          55.52716   12.84049   4.324 1.53e-05 ***
b42         -52.70284    9.33628  -5.645 1.66e-08 ***
b43          60.20860   12.84664   4.687 2.78e-06 ***
b44         -54.48451    9.33632  -5.836 5.39e-09 ***
b45          56.67652   12.84060   4.414 1.02e-05 ***
b46         -50.54334    9.32540  -5.420 5.99e-08 ***
b47          53.46017   12.83058   4.167 3.10e-05 ***
b48         -50.99014    9.32535  -5.468 4.58e-08 ***
b49          57.55082   12.84051   4.482 7.41e-06 ***
b50         -51.32227    9.33628  -5.497 3.88e-08 ***
b51          56.42799   12.84665   4.392 1.12e-05 ***
b52         -52.54248    9.33633  -5.628 1.84e-08 ***
b53          58.00457   12.84060   4.517 6.28e-06 ***
b54         -51.37362    9.32541  -5.509 3.63e-08 ***
b55          55.28632   12.83058   4.309 1.64e-05 ***
b56         -51.02592    9.32536  -5.472 4.48e-08 ***
b57          54.41485   12.84052   4.238 2.26e-05 ***
b58         -53.84541    9.33629  -5.767 8.10e-09 ***
b59          54.81471   12.84666   4.267 1.99e-05 ***
b60         -52.04558    9.33633  -5.575 2.50e-08 ***
b61          58.85466   12.84060   4.583 4.58e-06 ***
b62         -53.14747    9.32541  -5.699 1.21e-08 ***
b63          55.39549   12.83059   4.317 1.58e-05 ***
b64         -51.34551    9.32537  -5.506 3.69e-08 ***
b65          60.62220   12.84053   4.721 2.35e-06 ***
b66         -52.40980    9.33630  -5.614 1.99e-08 ***
b67          57.38678   12.84666   4.467 7.95e-06 ***
b68         -51.09386    9.33634  -5.473 4.46e-08 ***
b69          52.88406   12.84059   4.119 3.82e-05 ***
b70         -50.05804    9.32542  -5.368 8.00e-08 ***
b71          55.96400   12.83061   4.362 1.29e-05 ***
b72         -53.32085    9.32538  -5.718 1.09e-08 ***
b73          57.82885   12.84055   4.504 6.70e-06 ***
b74         -53.43916    9.33631  -5.724 1.05e-08 ***
b75          54.51776   12.84667   4.244 2.20e-05 ***
b76         -53.93445    9.33633  -5.777 7.66e-09 ***
b77          56.98553   12.84060   4.438 9.10e-06 ***
b78         -52.16997    9.32541  -5.594 2.23e-08 ***
b79          56.07397   12.83060   4.370 1.24e-05 ***
b80         -53.18486    9.32538  -5.703 1.18e-08 ***
b81          56.86710   12.84056   4.429 9.50e-06 ***
b82         -54.03507    9.33631  -5.788 7.18e-09 ***
b83          57.01271   12.84668   4.438 9.10e-06 ***
b84         -52.68447    9.33633  -5.643 1.68e-08 ***
b85          57.42580   12.84060   4.472 7.76e-06 ***
b86         -49.81437    9.32541  -5.342 9.24e-08 ***
b87          56.66297   12.83061   4.416 1.01e-05 ***
b88         -53.38274    9.32539  -5.724 1.04e-08 ***
b89          60.24215   12.84057   4.692 2.72e-06 ***
b90         -55.48387    9.33632  -5.943 2.82e-09 ***
b91          52.26747   12.84668   4.069 4.74e-05 ***
b92         -51.21395    9.33633  -5.485 4.14e-08 ***
b93          54.24231   12.84060   4.224 2.40e-05 ***
b94         -52.52570    9.32541  -5.633 1.79e-08 ***
b95          55.38841   12.83061   4.317 1.59e-05 ***
b96         -53.38209    9.32539  -5.724 1.04e-08 ***
b97          58.64276   12.84057   4.567 4.96e-06 ***
b98         -53.16511    9.33632  -5.694 1.24e-08 ***
b99          56.27031   12.84668   4.380 1.19e-05 ***
b100        -51.24377    9.33633  -5.489 4.07e-08 ***
b101         54.28076   12.84059   4.227 2.37e-05 ***
b102        -52.30301    9.32541  -5.609 2.05e-08 ***
b103         54.36404   12.83061   4.237 2.27e-05 ***
b104        -53.18385    9.32540  -5.703 1.18e-08 ***
b105         56.86927   12.84058   4.429 9.49e-06 ***
b106        -52.99213    9.33632  -5.676 1.39e-08 ***
b107         59.23003   12.84666   4.611 4.03e-06 ***
b108        -53.66525    9.33632  -5.748 9.08e-09 ***
b109         54.63561   12.84070   4.255 2.10e-05 ***
b110        -52.75936    9.32544  -5.658 1.54e-08 ***
b111         56.77338   12.83066   4.425 9.67e-06 ***
b112        -52.16202    9.32547  -5.594 2.24e-08 ***
b113         56.45945   12.84090   4.397 1.10e-05 ***
b114        -52.89805    9.33724  -5.665 1.48e-08 ***
b115         56.37345   12.84683   4.388 1.15e-05 ***
b116        -51.43605    9.33636  -5.509 3.62e-08 ***
b117         54.70681   12.84060   4.260 2.04e-05 ***
b118        -50.22907    9.32541  -5.386 7.23e-08 ***
b119         53.62261   12.83062   4.179 2.93e-05 ***
b120        -49.00871    9.32541  -5.255 1.48e-07 ***
b121         57.96027   12.84059   4.514 6.38e-06 ***
b122        -51.21438    9.33633  -5.485 4.14e-08 ***
b123         56.21855   12.84668   4.376 1.21e-05 ***
b124        -53.19785    9.33633  -5.698 1.22e-08 ***
b125         59.28615   12.84057   4.617 3.90e-06 ***
b126        -54.03387    9.32541  -5.794 6.90e-09 ***
b127         58.82764   12.83062   4.585 4.55e-06 ***
b128        -52.54529    9.32541  -5.635 1.76e-08 ***
b129         60.36532   12.84062   4.701 2.59e-06 ***
b130        -52.28845    9.33638  -5.601 2.15e-08 ***
b131         58.58150   12.84697   4.560 5.13e-06 ***
b132        -54.34106    9.33636  -5.820 5.91e-09 ***
b133         58.33277   12.84058   4.543 5.56e-06 ***
b134        -50.50596    9.32540  -5.416 6.13e-08 ***
b135         54.89632   12.83061   4.279 1.88e-05 ***
b136        -53.37126    9.32541  -5.723 1.05e-08 ***
b137         58.38847   12.84060   4.547 5.45e-06 ***
b138        -52.51500    9.33633  -5.625 1.87e-08 ***
b139         59.41012   12.84668   4.625 3.76e-06 ***
b140        -55.00637    9.33632  -5.892 3.85e-09 ***
b141         56.27207   12.84056   4.382 1.18e-05 ***
b142        -50.43768    9.32539  -5.409 6.38e-08 ***
b143         56.33387   12.83060   4.391 1.13e-05 ***
b144        -51.06820    9.32541  -5.476 4.37e-08 ***
b145         55.73772   12.84060   4.341 1.42e-05 ***
b146        -50.74595    9.33633  -5.435 5.50e-08 ***
b147         57.41029   12.84667   4.469 7.88e-06 ***
b148        -53.19961    9.33631  -5.698 1.22e-08 ***
b149         56.02558   12.84055   4.363 1.28e-05 ***
b150        -52.12323    9.32538  -5.589 2.29e-08 ***
b151         58.64007   12.83060   4.570 4.88e-06 ***
b152        -53.44375    9.32541  -5.731 1.00e-08 ***
b153         57.38006   12.84060   4.469 7.89e-06 ***
b154        -53.16390    9.33633  -5.694 1.25e-08 ***
b155         58.60453   12.84667   4.562 5.08e-06 ***
b156        -52.49880    9.33631  -5.623 1.89e-08 ***
b157         56.73728   12.84053   4.419 9.96e-06 ***
b158        -52.77551    9.32538  -5.659 1.53e-08 ***
b159         57.52867   12.83059   4.484 7.35e-06 ***
b160        -51.70241    9.32541  -5.544 2.97e-08 ***
b161         57.37754   12.84060   4.468 7.90e-06 ***
b162        -52.32506    9.33633  -5.604 2.10e-08 ***
b163         55.69875   12.84666   4.336 1.46e-05 ***
b164        -50.61378    9.33630  -5.421 5.95e-08 ***
b165         54.18088   12.84052   4.220 2.45e-05 ***
b166        -49.95154    9.32537  -5.357 8.52e-08 ***
b167         55.13003   12.83059   4.297 1.74e-05 ***
b168        -53.16071    9.32541  -5.701 1.20e-08 ***
b169         58.80719   12.84060   4.580 4.67e-06 ***
b170        -51.34004    9.33633  -5.499 3.84e-08 ***
b171         56.62902   12.84665   4.408 1.05e-05 ***
b172        -53.24428    9.33630  -5.703 1.18e-08 ***
b173         59.47794   12.84051   4.632 3.63e-06 ***
b174        -52.51741    9.32536  -5.632 1.79e-08 ***
b175         58.59705   12.83058   4.567 4.96e-06 ***
b176        -55.30397    9.32541  -5.930 3.04e-09 ***
b177         59.38250   12.84060   4.625 3.76e-06 ***
b178        -53.25879    9.33633  -5.704 1.17e-08 ***
b179         56.76443   12.84664   4.419 9.95e-06 ***
b180        -52.62417    9.33629  -5.637 1.74e-08 ***
b181         58.02249   12.84049   4.519 6.24e-06 ***
b182        -52.41491    9.32535  -5.621 1.91e-08 ***
b183         59.90837   12.83057   4.669 3.03e-06 ***
b184        -55.81170    9.32541  -5.985 2.18e-09 ***
b185         59.94962   12.84060   4.669 3.04e-06 ***
b186        -53.63345    9.33632  -5.745 9.27e-09 ***
b187         56.86472   12.84663   4.426 9.60e-06 ***
b188        -51.85805    9.33628  -5.554 2.80e-08 ***
b189         59.29011   12.84048   4.617 3.90e-06 ***
b190        -52.20806    9.32534  -5.599 2.17e-08 ***
b191         56.79105   12.83056   4.426 9.61e-06 ***
b192        -51.59895    9.32540  -5.533 3.16e-08 ***
b193         58.06600   12.84059   4.522 6.14e-06 ***
b194        -53.21132    9.33632  -5.699 1.21e-08 ***
b195         60.06039   12.84662   4.675 2.94e-06 ***
b196        -55.12047    9.33627  -5.904 3.57e-09 ***
b197         61.61590   12.84046   4.799 1.60e-06 ***
b198        -53.97894    9.32533  -5.788 7.15e-09 ***
b199         60.01834   12.83055   4.678 2.91e-06 ***
b200        -53.24113    9.32540  -5.709 1.14e-08 ***
b201         59.07730   12.84059   4.601 4.22e-06 ***
b202        -54.01446    9.33631  -5.785 7.28e-09 ***
b203         59.53365   12.84661   4.634 3.59e-06 ***
b204        -53.28105    9.33626  -5.707 1.16e-08 ***
b205         61.20029   12.84044   4.766 1.88e-06 ***
b206        -52.10391    9.32532  -5.587 2.32e-08 ***
b207         56.44949   12.83053   4.400 1.09e-05 ***
b208        -53.19352    9.32539  -5.704 1.18e-08 ***
b209         57.95692   12.84058   4.514 6.39e-06 ***
b210        -52.90690    9.33631  -5.667 1.46e-08 ***
b211         55.43880   12.84660   4.315 1.60e-05 ***
b212        -50.77870    9.33625  -5.439 5.39e-08 ***
b213         60.14096   12.84042   4.684 2.82e-06 ***
b214        -53.27339    9.32531  -5.713 1.12e-08 ***
b215         56.67326   12.83052   4.417 1.00e-05 ***
b216        -51.23397    9.32539  -5.494 3.95e-08 ***
b217         57.92758   12.84057   4.511 6.46e-06 ***
b218        -53.90236    9.33630  -5.773 7.82e-09 ***
b219         62.43397   12.84658   4.860 1.18e-06 ***
b220        -52.26089    9.33624  -5.598 2.18e-08 ***
b221         60.85438   12.84040   4.739 2.15e-06 ***
b222        -51.05242    9.32530  -5.475 4.41e-08 ***
b223         60.16774   12.83051   4.689 2.75e-06 ***
b224        -53.60701    9.32538  -5.749 9.06e-09 ***
b225         58.09938   12.84056   4.525 6.06e-06 ***
b226        -48.96696    9.33629  -5.245 1.57e-07 ***
b227         60.06571   12.84657   4.676 2.94e-06 ***
b228        -52.22245    9.33623  -5.594 2.24e-08 ***
b229         56.58226   12.84038   4.407 1.05e-05 ***
b230        -50.82818    9.32529  -5.451 5.05e-08 ***
b231         58.05893   12.83049   4.525 6.05e-06 ***
b232        -51.97628    9.32538  -5.574 2.51e-08 ***
b233         58.00865   12.84055   4.518 6.27e-06 ***
b234        -49.96065    9.33629  -5.351 8.78e-08 ***
b235         60.19237   12.84655   4.685 2.80e-06 ***
b236        -51.62691    9.33621  -5.530 3.22e-08 ***
b237         59.11534   12.84036   4.604 4.16e-06 ***
b238        -51.69103    9.32527  -5.543 2.99e-08 ***
b239         59.30632   12.83047   4.622 3.80e-06 ***
b240        -53.68454    9.32537  -5.757 8.62e-09 ***
b241         59.13139   12.84054   4.605 4.13e-06 ***
b242        -53.95564    9.33628  -5.779 7.55e-09 ***
b243         64.17431   12.84653   4.995 5.89e-07 ***
b244        -53.47732    9.33620  -5.728 1.02e-08 ***
b245         59.34127   12.84033   4.621 3.82e-06 ***
b246        -50.38385    9.32526  -5.403 6.59e-08 ***
b247         62.29288   12.83045   4.855 1.21e-06 ***
b248        -51.77168    9.32536  -5.552 2.84e-08 ***
b249         59.64279   12.84053   4.645 3.41e-06 ***
b250        -52.48503    9.33627  -5.622 1.90e-08 ***
b251         56.19000   12.84651   4.374 1.22e-05 ***
b252        -50.54076    9.33618  -5.413 6.21e-08 ***
b253         54.92023   12.84030   4.277 1.90e-05 ***
b254        -47.89887    9.32523  -5.136 2.81e-07 ***
b255         58.49466   12.83040   4.559 5.15e-06 ***
b256        -50.03820    9.32530  -5.366 8.09e-08 ***
b257         59.35919   12.84031   4.623 3.79e-06 ***
b258        -52.01040    9.33608  -5.571 2.55e-08 ***
b259         59.68889   12.84816   4.646 3.40e-06 ***
b260        -51.86377    9.33659  -5.555 2.79e-08 ***
b261         57.03959   12.83782   4.443 8.89e-06 ***
b262        -52.70931    9.32380  -5.653 1.58e-08 ***
b263         62.38761   12.82159   4.866 1.14e-06 ***
b264        -51.78779    9.32579  -5.553 2.82e-08 ***
b265         60.85644   12.83394   4.742 2.12e-06 ***
b266        -50.67268    9.34451  -5.423 5.90e-08 ***
b267         59.24462   12.81884   4.622 3.82e-06 ***
b268        -51.26637    9.39026  -5.460 4.80e-08 ***
b269         62.49669   12.67225   4.932 8.18e-07 ***
b270         -9.36941    8.64948  -1.083  0.27871    
b271               NA         NA      NA       NA    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 4.72 on 48391 degrees of freedom
  (478 observations deleted due to missingness)
Multiple R-squared:  0.8529,	Adjusted R-squared:  0.8521 
F-statistic: 988.2 on 284 and 48391 DF,  p-value: < 2.2e-16

> # Toronto
> summary(lms[[3]])

Call:
lm(formula = "mean_temp~.", data = data[row_ids[, k], x_cols])

Residuals:
     Min       1Q   Median       3Q      Max 
-20.3948  -2.6880   0.0044   2.7844  16.0367 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  1.239e+01  3.047e+00   4.066 4.80e-05 ***
s1           4.647e+00  1.773e+00   2.621 0.008767 ** 
s2          -1.075e-01  2.403e-02  -4.473 7.73e-06 ***
s4           5.555e-02  6.178e-02   0.899 0.368563    
s6           9.218e-02  2.400e-02   3.841 0.000123 ***
s8           2.001e-01  2.556e-02   7.830 4.97e-15 ***
s10          9.879e-02  2.400e-02   4.116 3.85e-05 ***
s12          2.712e-02  2.404e-02   1.128 0.259312    
c1          -1.041e+01  3.290e-01 -31.646  < 2e-16 ***
c2           9.779e-03  2.405e-02   0.407 0.684316    
c4           3.049e-01  4.226e-02   7.217 5.40e-13 ***
c6           2.796e-02  2.400e-02   1.165 0.244150    
c8          -6.383e-02  2.658e-02  -2.402 0.016323 *  
c10          1.662e-01  2.400e-02   6.927 4.34e-12 ***
c12          7.831e-02  2.452e-02   3.194 0.001403 ** 
b1          -2.353e+01  4.524e+00  -5.201 1.98e-07 ***
b2           1.282e+01  4.949e+00   2.591 0.009570 ** 
b3          -2.475e+01  4.223e+00  -5.860 4.64e-09 ***
b4           1.359e+01  5.091e+00   2.670 0.007587 ** 
b5          -2.245e+01  4.177e+00  -5.375 7.69e-08 ***
b6           1.235e+01  5.116e+00   2.414 0.015794 *  
b7          -2.567e+01  4.166e+00  -6.162 7.25e-10 ***
b8           1.284e+01  5.112e+00   2.512 0.011994 *  
b9          -2.222e+01  4.160e+00  -5.342 9.22e-08 ***
b10          1.248e+01  5.113e+00   2.441 0.014637 *  
b11         -2.232e+01  4.164e+00  -5.361 8.32e-08 ***
b12          1.161e+01  5.122e+00   2.268 0.023348 *  
b13         -2.407e+01  4.166e+00  -5.777 7.66e-09 ***
b14          1.577e+01  5.122e+00   3.079 0.002074 ** 
b15         -2.642e+01  4.164e+00  -6.345 2.24e-10 ***
b16          1.329e+01  5.113e+00   2.600 0.009337 ** 
b17         -2.344e+01  4.159e+00  -5.636 1.74e-08 ***
b18          1.252e+01  5.113e+00   2.448 0.014355 *  
b19         -2.588e+01  4.164e+00  -6.216 5.15e-10 ***
b20          1.412e+01  5.122e+00   2.756 0.005849 ** 
b21         -2.379e+01  4.166e+00  -5.710 1.13e-08 ***
b22          1.230e+01  5.122e+00   2.401 0.016357 *  
b23         -2.356e+01  4.164e+00  -5.658 1.53e-08 ***
b24          1.207e+01  5.113e+00   2.361 0.018215 *  
b25         -2.692e+01  4.159e+00  -6.472 9.72e-11 ***
b26          1.410e+01  5.113e+00   2.757 0.005832 ** 
b27         -2.478e+01  4.164e+00  -5.951 2.68e-09 ***
b28          1.371e+01  5.122e+00   2.676 0.007443 ** 
b29         -2.612e+01  4.166e+00  -6.271 3.62e-10 ***
b30          1.554e+01  5.122e+00   3.034 0.002412 ** 
b31         -2.659e+01  4.164e+00  -6.386 1.71e-10 ***
b32          1.443e+01  5.113e+00   2.821 0.004786 ** 
b33         -2.856e+01  4.159e+00  -6.867 6.64e-12 ***
b34          1.468e+01  5.113e+00   2.872 0.004083 ** 
b35         -2.844e+01  4.164e+00  -6.830 8.59e-12 ***
b36          1.439e+01  5.122e+00   2.811 0.004947 ** 
b37         -2.474e+01  4.166e+00  -5.939 2.88e-09 ***
b38          1.389e+01  5.122e+00   2.712 0.006691 ** 
b39         -2.258e+01  4.164e+00  -5.422 5.92e-08 ***
b40          1.160e+01  5.113e+00   2.268 0.023329 *  
b41         -2.349e+01  4.160e+00  -5.647 1.64e-08 ***
b42          1.331e+01  5.113e+00   2.604 0.009228 ** 
b43         -2.582e+01  4.164e+00  -6.202 5.61e-10 ***
b44          1.467e+01  5.122e+00   2.864 0.004183 ** 
b45         -2.537e+01  4.166e+00  -6.089 1.15e-09 ***
b46          1.444e+01  5.122e+00   2.820 0.004800 ** 
b47         -2.403e+01  4.164e+00  -5.772 7.86e-09 ***
b48          1.323e+01  5.113e+00   2.587 0.009686 ** 
b49         -2.347e+01  4.160e+00  -5.644 1.67e-08 ***
b50          1.378e+01  5.113e+00   2.694 0.007056 ** 
b51         -2.508e+01  4.164e+00  -6.024 1.71e-09 ***
b52          1.536e+01  5.122e+00   3.000 0.002705 ** 
b53         -2.581e+01  4.166e+00  -6.195 5.86e-10 ***
b54          1.418e+01  5.122e+00   2.769 0.005626 ** 
b55         -2.556e+01  4.164e+00  -6.138 8.42e-10 ***
b56          1.503e+01  5.114e+00   2.940 0.003284 ** 
b57         -2.659e+01  4.160e+00  -6.391 1.65e-10 ***
b58          1.540e+01  5.113e+00   3.012 0.002597 ** 
b59         -2.612e+01  4.164e+00  -6.273 3.57e-10 ***
b60          1.268e+01  5.122e+00   2.475 0.013331 *  
b61         -2.333e+01  4.166e+00  -5.599 2.17e-08 ***
b62          1.497e+01  5.122e+00   2.923 0.003464 ** 
b63         -2.357e+01  4.164e+00  -5.662 1.51e-08 ***
b64          1.298e+01  5.114e+00   2.539 0.011125 *  
b65         -2.660e+01  4.160e+00  -6.395 1.62e-10 ***
b66          1.481e+01  5.113e+00   2.896 0.003786 ** 
b67         -2.811e+01  4.164e+00  -6.752 1.47e-11 ***
b68          1.477e+01  5.122e+00   2.883 0.003936 ** 
b69         -2.670e+01  4.166e+00  -6.409 1.48e-10 ***
b70          1.550e+01  5.122e+00   3.025 0.002484 ** 
b71         -2.940e+01  4.164e+00  -7.060 1.68e-12 ***
b72          1.396e+01  5.114e+00   2.730 0.006340 ** 
b73         -2.447e+01  4.160e+00  -5.882 4.08e-09 ***
b74          1.315e+01  5.113e+00   2.571 0.010130 *  
b75         -2.595e+01  4.164e+00  -6.232 4.62e-10 ***
b76          1.603e+01  5.122e+00   3.129 0.001755 ** 
b77         -2.163e+01  4.166e+00  -5.191 2.09e-07 ***
b78          1.470e+01  5.122e+00   2.871 0.004099 ** 
b79         -2.654e+01  4.164e+00  -6.373 1.86e-10 ***
b80          1.483e+01  5.114e+00   2.899 0.003743 ** 
b81         -2.200e+01  4.160e+00  -5.290 1.23e-07 ***
b82          1.276e+01  5.113e+00   2.496 0.012560 *  
b83         -2.726e+01  4.164e+00  -6.548 5.89e-11 ***
b84          1.861e+01  5.122e+00   3.633 0.000280 ***
b85         -2.534e+01  4.166e+00  -6.082 1.19e-09 ***
b86          1.527e+01  5.122e+00   2.982 0.002868 ** 
b87         -2.793e+01  4.164e+00  -6.708 2.00e-11 ***
b88          1.333e+01  5.114e+00   2.607 0.009144 ** 
b89         -2.624e+01  4.160e+00  -6.309 2.83e-10 ***
b90          1.535e+01  5.113e+00   3.001 0.002690 ** 
b91         -3.025e+01  4.164e+00  -7.266 3.75e-13 ***
b92          1.477e+01  5.122e+00   2.884 0.003923 ** 
b93         -2.519e+01  4.166e+00  -6.046 1.49e-09 ***
b94          1.331e+01  5.122e+00   2.598 0.009382 ** 
b95         -2.558e+01  4.164e+00  -6.143 8.17e-10 ***
b96          1.481e+01  5.114e+00   2.897 0.003769 ** 
b97         -2.796e+01  4.160e+00  -6.721 1.82e-11 ***
b98          1.466e+01  5.113e+00   2.867 0.004144 ** 
b99         -2.422e+01  4.164e+00  -5.816 6.04e-09 ***
b100         1.407e+01  5.122e+00   2.747 0.006019 ** 
b101        -2.246e+01  4.166e+00  -5.391 7.02e-08 ***
b102         1.264e+01  5.122e+00   2.467 0.013626 *  
b103        -2.392e+01  4.164e+00  -5.743 9.32e-09 ***
b104         1.442e+01  5.114e+00   2.819 0.004817 ** 
b105        -2.449e+01  4.160e+00  -5.887 3.95e-09 ***
b106         1.428e+01  5.113e+00   2.792 0.005237 ** 
b107        -2.656e+01  4.164e+00  -6.378 1.80e-10 ***
b108         1.483e+01  5.122e+00   2.896 0.003778 ** 
b109        -2.349e+01  4.166e+00  -5.638 1.73e-08 ***
b110         1.484e+01  5.122e+00   2.897 0.003764 ** 
b111        -2.510e+01  4.164e+00  -6.028 1.67e-09 ***
b112         1.379e+01  5.114e+00   2.697 0.007008 ** 
b113        -2.384e+01  4.160e+00  -5.731 1.00e-08 ***
b114         1.456e+01  5.114e+00   2.848 0.004400 ** 
b115        -2.399e+01  4.164e+00  -5.762 8.34e-09 ***
b116         1.480e+01  5.122e+00   2.890 0.003853 ** 
b117        -2.237e+01  4.167e+00  -5.367 8.03e-08 ***
b118         1.573e+01  5.124e+00   3.071 0.002136 ** 
b119        -2.537e+01  4.168e+00  -6.088 1.15e-09 ***
b120         1.644e+01  5.124e+00   3.208 0.001338 ** 
b121        -2.568e+01  4.168e+00  -6.162 7.25e-10 ***
b122         1.778e+01  5.124e+00   3.469 0.000522 ***
b123        -2.479e+01  4.168e+00  -5.947 2.75e-09 ***
b124         1.551e+01  5.124e+00   3.028 0.002467 ** 
b125        -2.370e+01  4.167e+00  -5.687 1.30e-08 ***
b126         1.354e+01  5.122e+00   2.644 0.008203 ** 
b127        -2.119e+01  4.164e+00  -5.088 3.63e-07 ***
b128         1.278e+01  5.114e+00   2.499 0.012442 *  
b129        -2.621e+01  4.160e+00  -6.302 2.97e-10 ***
b130         1.378e+01  5.114e+00   2.694 0.007063 ** 
b131        -2.622e+01  4.164e+00  -6.297 3.05e-10 ***
b132         1.608e+01  5.122e+00   3.140 0.001689 ** 
b133        -2.362e+01  4.167e+00  -5.669 1.44e-08 ***
b134         1.607e+01  5.122e+00   3.137 0.001707 ** 
b135        -2.618e+01  4.164e+00  -6.288 3.24e-10 ***
b136         1.450e+01  5.114e+00   2.836 0.004569 ** 
b137        -2.431e+01  4.160e+00  -5.845 5.09e-09 ***
b138         1.625e+01  5.114e+00   3.178 0.001485 ** 
b139        -2.329e+01  4.164e+00  -5.594 2.23e-08 ***
b140         1.368e+01  5.122e+00   2.671 0.007574 ** 
b141        -2.152e+01  4.167e+00  -5.165 2.41e-07 ***
b142         1.328e+01  5.122e+00   2.592 0.009551 ** 
b143        -2.246e+01  4.164e+00  -5.393 6.94e-08 ***
b144         1.571e+01  5.114e+00   3.071 0.002133 ** 
b145        -2.689e+01  4.160e+00  -6.465 1.02e-10 ***
b146         1.640e+01  5.114e+00   3.208 0.001339 ** 
b147        -2.275e+01  4.164e+00  -5.463 4.69e-08 ***
b148         1.575e+01  5.122e+00   3.075 0.002105 ** 
b149        -2.398e+01  4.167e+00  -5.755 8.73e-09 ***
b150         1.571e+01  5.122e+00   3.067 0.002160 ** 
b151        -2.389e+01  4.164e+00  -5.738 9.62e-09 ***
b152         1.571e+01  5.114e+00   3.072 0.002127 ** 
b153        -2.461e+01  4.160e+00  -5.915 3.33e-09 ***
b154         1.632e+01  5.114e+00   3.190 0.001421 ** 
b155        -2.543e+01  4.164e+00  -6.107 1.02e-09 ***
b156         1.285e+01  5.122e+00   2.509 0.012109 *  
b157        -2.519e+01  4.167e+00  -6.045 1.51e-09 ***
b158         1.574e+01  5.122e+00   3.074 0.002116 ** 
b159        -2.099e+01  4.164e+00  -5.041 4.65e-07 ***
b160         1.539e+01  5.114e+00   3.009 0.002622 ** 
b161        -2.635e+01  4.160e+00  -6.334 2.41e-10 ***
b162         1.638e+01  5.114e+00   3.203 0.001359 ** 
b163        -2.001e+01  4.164e+00  -4.805 1.55e-06 ***
b164         1.582e+01  5.122e+00   3.088 0.002015 ** 
b165        -2.259e+01  4.167e+00  -5.422 5.92e-08 ***
b166         1.635e+01  5.122e+00   3.192 0.001412 ** 
b167        -2.606e+01  4.164e+00  -6.259 3.89e-10 ***
b168         1.607e+01  5.114e+00   3.142 0.001679 ** 
b169        -2.424e+01  4.160e+00  -5.826 5.70e-09 ***
b170         1.339e+01  5.114e+00   2.618 0.008838 ** 
b171        -2.259e+01  4.164e+00  -5.426 5.78e-08 ***
b172         1.410e+01  5.122e+00   2.753 0.005899 ** 
b173        -2.567e+01  4.167e+00  -6.160 7.32e-10 ***
b174         1.380e+01  5.122e+00   2.695 0.007044 ** 
b175        -2.362e+01  4.164e+00  -5.673 1.41e-08 ***
b176         1.534e+01  5.114e+00   3.000 0.002699 ** 
b177        -2.363e+01  4.160e+00  -5.681 1.34e-08 ***
b178         1.473e+01  5.114e+00   2.881 0.003962 ** 
b179        -2.225e+01  4.164e+00  -5.344 9.14e-08 ***
b180         1.352e+01  5.122e+00   2.639 0.008319 ** 
b181        -2.272e+01  4.167e+00  -5.453 4.96e-08 ***
b182         1.562e+01  5.122e+00   3.049 0.002296 ** 
b183        -2.320e+01  4.164e+00  -5.570 2.55e-08 ***
b184         1.815e+01  5.114e+00   3.549 0.000387 ***
b185        -2.201e+01  4.160e+00  -5.292 1.21e-07 ***
b186         1.412e+01  5.114e+00   2.761 0.005772 ** 
b187        -2.028e+01  4.164e+00  -4.870 1.12e-06 ***
b188         1.392e+01  5.122e+00   2.718 0.006576 ** 
b189        -2.543e+01  4.167e+00  -6.104 1.04e-09 ***
b190         1.605e+01  5.122e+00   3.134 0.001725 ** 
b191        -2.403e+01  4.164e+00  -5.771 7.94e-09 ***
b192         1.519e+01  5.114e+00   2.970 0.002980 ** 
b193        -2.458e+01  4.160e+00  -5.908 3.48e-09 ***
b194         1.592e+01  5.114e+00   3.113 0.001852 ** 
b195        -2.220e+01  4.164e+00  -5.331 9.78e-08 ***
b196         1.453e+01  5.122e+00   2.836 0.004565 ** 
b197        -2.242e+01  4.167e+00  -5.382 7.40e-08 ***
b198         1.651e+01  5.122e+00   3.223 0.001269 ** 
b199        -2.411e+01  4.164e+00  -5.791 7.04e-09 ***
b200         1.656e+01  5.114e+00   3.238 0.001203 ** 
b201        -2.553e+01  4.160e+00  -6.137 8.45e-10 ***
b202         1.515e+01  5.114e+00   2.963 0.003044 ** 
b203        -2.285e+01  4.164e+00  -5.488 4.08e-08 ***
b204         1.647e+01  5.122e+00   3.215 0.001305 ** 
b205        -2.173e+01  4.167e+00  -5.216 1.83e-07 ***
b206         1.493e+01  5.122e+00   2.914 0.003569 ** 
b207        -2.407e+01  4.164e+00  -5.781 7.45e-09 ***
b208         1.527e+01  5.114e+00   2.987 0.002823 ** 
b209        -2.287e+01  4.160e+00  -5.498 3.85e-08 ***
b210         1.549e+01  5.114e+00   3.030 0.002448 ** 
b211        -2.298e+01  4.164e+00  -5.520 3.41e-08 ***
b212         1.475e+01  5.122e+00   2.879 0.003990 ** 
b213        -2.246e+01  4.167e+00  -5.391 7.03e-08 ***
b214         1.637e+01  5.122e+00   3.196 0.001395 ** 
b215        -2.432e+01  4.164e+00  -5.842 5.20e-09 ***
b216         1.728e+01  5.114e+00   3.379 0.000729 ***
b217        -2.510e+01  4.160e+00  -6.035 1.60e-09 ***
b218         1.770e+01  5.114e+00   3.462 0.000537 ***
b219        -2.160e+01  4.164e+00  -5.186 2.15e-07 ***
b220         1.738e+01  5.122e+00   3.392 0.000693 ***
b221        -2.382e+01  4.166e+00  -5.717 1.09e-08 ***
b222         1.495e+01  5.122e+00   2.918 0.003520 ** 
b223        -2.096e+01  4.164e+00  -5.033 4.84e-07 ***
b224         1.450e+01  5.114e+00   2.836 0.004570 ** 
b225        -2.143e+01  4.160e+00  -5.153 2.57e-07 ***
b226         1.589e+01  5.114e+00   3.107 0.001889 ** 
b227        -2.076e+01  4.164e+00  -4.986 6.20e-07 ***
b228         1.637e+01  5.122e+00   3.196 0.001394 ** 
b229        -2.154e+01  4.166e+00  -5.170 2.35e-07 ***
b230         1.474e+01  5.122e+00   2.879 0.003996 ** 
b231        -2.069e+01  4.164e+00  -4.969 6.76e-07 ***
b232         1.708e+01  5.114e+00   3.340 0.000839 ***
b233        -2.457e+01  4.160e+00  -5.906 3.53e-09 ***
b234         1.534e+01  5.114e+00   3.000 0.002700 ** 
b235        -2.159e+01  4.164e+00  -5.185 2.17e-07 ***
b236         1.543e+01  5.122e+00   3.013 0.002590 ** 
b237        -2.170e+01  4.166e+00  -5.209 1.90e-07 ***
b238         1.446e+01  5.122e+00   2.824 0.004748 ** 
b239        -2.350e+01  4.164e+00  -5.643 1.67e-08 ***
b240         1.830e+01  5.114e+00   3.579 0.000345 ***
b241        -2.471e+01  4.160e+00  -5.941 2.85e-09 ***
b242         1.721e+01  5.114e+00   3.366 0.000764 ***
b243        -2.427e+01  4.164e+00  -5.828 5.63e-09 ***
b244         1.729e+01  5.122e+00   3.376 0.000735 ***
b245        -2.281e+01  4.166e+00  -5.475 4.38e-08 ***
b246         1.579e+01  5.122e+00   3.083 0.002047 ** 
b247        -2.418e+01  4.164e+00  -5.808 6.36e-09 ***
b248         1.664e+01  5.114e+00   3.254 0.001140 ** 
b249        -2.228e+01  4.160e+00  -5.357 8.52e-08 ***
b250         1.548e+01  5.114e+00   3.028 0.002462 ** 
b251        -2.328e+01  4.164e+00  -5.592 2.26e-08 ***
b252         1.510e+01  5.122e+00   2.947 0.003207 ** 
b253        -2.241e+01  4.166e+00  -5.379 7.51e-08 ***
b254         1.576e+01  5.122e+00   3.077 0.002089 ** 
b255        -2.300e+01  4.164e+00  -5.525 3.32e-08 ***
b256         1.457e+01  5.114e+00   2.850 0.004379 ** 
b257        -2.294e+01  4.160e+00  -5.515 3.51e-08 ***
b258         1.604e+01  5.114e+00   3.136 0.001711 ** 
b259        -2.280e+01  4.164e+00  -5.476 4.37e-08 ***
b260         1.624e+01  5.122e+00   3.170 0.001525 ** 
b261        -2.436e+01  4.166e+00  -5.847 5.03e-09 ***
b262         1.816e+01  5.122e+00   3.546 0.000391 ***
b263        -2.519e+01  4.164e+00  -6.050 1.45e-09 ***
b264         1.860e+01  5.114e+00   3.637 0.000276 ***
b265        -2.416e+01  4.160e+00  -5.809 6.33e-09 ***
b266         1.568e+01  5.114e+00   3.067 0.002162 ** 
b267        -2.170e+01  4.164e+00  -5.213 1.87e-07 ***
b268         1.722e+01  5.122e+00   3.362 0.000775 ***
b269        -2.308e+01  4.166e+00  -5.540 3.04e-08 ***
b270         1.555e+01  5.122e+00   3.036 0.002399 ** 
b271        -2.098e+01  4.164e+00  -5.038 4.71e-07 ***
b272         1.550e+01  5.114e+00   3.032 0.002431 ** 
b273        -2.014e+01  4.160e+00  -4.841 1.29e-06 ***
b274         1.241e+01  5.114e+00   2.427 0.015245 *  
b275        -2.170e+01  4.164e+00  -5.211 1.88e-07 ***
b276         1.618e+01  5.122e+00   3.159 0.001583 ** 
b277        -2.480e+01  4.166e+00  -5.952 2.67e-09 ***
b278         1.623e+01  5.122e+00   3.169 0.001532 ** 
b279        -2.392e+01  4.164e+00  -5.744 9.30e-09 ***
b280         1.534e+01  5.114e+00   3.000 0.002699 ** 
b281        -2.184e+01  4.160e+00  -5.249 1.53e-07 ***
b282         1.383e+01  5.114e+00   2.705 0.006827 ** 
b283        -2.176e+01  4.164e+00  -5.227 1.73e-07 ***
b284         1.491e+01  5.122e+00   2.910 0.003611 ** 
b285        -2.400e+01  4.166e+00  -5.761 8.39e-09 ***
b286         1.608e+01  5.122e+00   3.139 0.001699 ** 
b287        -2.090e+01  4.164e+00  -5.020 5.18e-07 ***
b288         1.566e+01  5.114e+00   3.063 0.002193 ** 
b289        -2.362e+01  4.160e+00  -5.679 1.36e-08 ***
b290         1.612e+01  5.114e+00   3.153 0.001616 ** 
b291        -2.159e+01  4.164e+00  -5.186 2.15e-07 ***
b292         1.467e+01  5.122e+00   2.863 0.004193 ** 
b293        -2.086e+01  4.166e+00  -5.006 5.56e-07 ***
b294         1.373e+01  5.122e+00   2.681 0.007335 ** 
b295        -1.872e+01  4.164e+00  -4.497 6.90e-06 ***
b296         1.485e+01  5.114e+00   2.904 0.003686 ** 
b297        -2.113e+01  4.160e+00  -5.081 3.77e-07 ***
b298         1.596e+01  5.114e+00   3.122 0.001800 ** 
b299        -2.184e+01  4.164e+00  -5.246 1.56e-07 ***
b300         1.481e+01  5.122e+00   2.891 0.003844 ** 
b301        -2.104e+01  4.166e+00  -5.049 4.44e-07 ***
b302         1.514e+01  5.122e+00   2.957 0.003110 ** 
b303        -1.926e+01  4.164e+00  -4.627 3.72e-06 ***
b304         1.614e+01  5.114e+00   3.157 0.001595 ** 
b305        -2.222e+01  4.160e+00  -5.341 9.28e-08 ***
b306         1.367e+01  5.114e+00   2.673 0.007518 ** 
b307        -2.148e+01  4.164e+00  -5.157 2.51e-07 ***
b308         1.497e+01  5.122e+00   2.922 0.003481 ** 
b309        -2.428e+01  4.166e+00  -5.828 5.64e-09 ***
b310         1.743e+01  5.122e+00   3.404 0.000665 ***
b311        -2.134e+01  4.164e+00  -5.125 2.98e-07 ***
b312         1.587e+01  5.113e+00   3.103 0.001919 ** 
b313        -2.433e+01  4.160e+00  -5.850 4.95e-09 ***
b314         1.652e+01  5.114e+00   3.230 0.001240 ** 
b315        -2.239e+01  4.164e+00  -5.378 7.54e-08 ***
b316         1.473e+01  5.122e+00   2.875 0.004036 ** 
b317        -1.803e+01  4.166e+00  -4.327 1.51e-05 ***
b318         1.613e+01  5.122e+00   3.149 0.001639 ** 
b319        -1.955e+01  4.164e+00  -4.696 2.66e-06 ***
b320         1.645e+01  5.113e+00   3.217 0.001296 ** 
b321        -1.990e+01  4.159e+00  -4.785 1.71e-06 ***
b322         1.455e+01  5.113e+00   2.845 0.004437 ** 
b323        -2.144e+01  4.163e+00  -5.151 2.60e-07 ***
b324         1.799e+01  5.119e+00   3.514 0.000442 ***
b325        -2.023e+01  4.160e+00  -4.863 1.16e-06 ***
b326         1.692e+01  5.108e+00   3.313 0.000922 ***
b327        -2.438e+01  4.152e+00  -5.871 4.36e-09 ***
b328         1.789e+01  5.309e+00   3.369 0.000755 ***
b329         7.342e+02  2.463e+03   0.298 0.765678    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 4.144 on 59307 degrees of freedom
  (7401 observations deleted due to missingness)
Multiple R-squared:  0.8409,	Adjusted R-squared:   0.84 
F-statistic: 914.2 on 343 and 59307 DF,  p-value: < 2.2e-16

> 
> # register the results
> data <- data %>% mutate(mu = NA , ctemp = NA)
> for(k in 1:p){
+   data[non_na & row_ids[,k],] <- data[non_na & row_ids[,k],] %>% 
+     mutate(mu = lms[[k]]$fitted.values, ctemp = mean_temp - mu)
+ }
> 
> # remove b cols of data (for memory)
> data <- data %>% 
+   select(!any_of(b_cols[[which.max(sapply(b_cols, length))]])) %>%
+   select(!any_of(c(s_cols, c_cols)))
> gc()
            used   (Mb) gc trigger   (Mb)  max used   (Mb)
Ncells   2494463  133.3    4520295  241.5   4520295  241.5
Vcells 187253933 1428.7  614509820 4688.4 512022665 3906.5
> 
> # quick check
> data0 <- data %>% group_by(year, station_name) %>%
+   summarise(m_mt = mean(mean_temp, na.rm=T),
+             m_mu = mean(mu, na.rm=T))
`summarise()` has grouped output by 'year'. You can override using the
`.groups` argument.
> ggplot(data0, aes(x=year, y=m_mt, col=station_name, group=station_name)) +
+   theme_light() +
+   geom_line(data = data0, aes(y=m_mu), col=1) +
+   geom_point()
Warning messages:
1: Removed 20 row(s) containing missing values (geom_path). 
2: Removed 25 rows containing missing values (geom_point). 
> 
> data0 <- data %>% filter(year %in% 1950:1970) %>%
+   group_by(year, month, station_name) %>%
+   summarise(m_mt = mean(mean_temp, na.rm=T),
+             m_mu = mean(mu, na.rm=T))
`summarise()` has grouped output by 'year', 'month'. You can override using the
`.groups` argument.
> ggplot(data0, aes(x=year+month/12, y=m_mt, col=station_name, group=station_name)) +
+   geom_line() + geom_point() +
+   geom_line(data = data0, aes(y=m_mu)) +
+   facet_wrap(~station_name)
Warning messages:
1: Removed 21 row(s) containing missing values (geom_path). 
2: Removed 21 rows containing missing values (geom_point). 
3: Removed 21 row(s) containing missing values (geom_path). 
> 
> 
> # random check of the fits
> # some plots might show a break (when the data goes from Ottawa to Toronto)
> k <- sample(nrow(data),1)
> ii <- k + 1:365
> plot(data$time[ii], data$mean_temp[ii])
> lines(data$time[ii], data$mu[ii], col=2)
> 
> 
> # note that this breaks the equalities in the data
> # but there is still some heterogeneity in the variance
> N <- 20000 
> par(mfrow=c(p,2), mar=c(1,1,0,0))
> for(k in 1:p){
+   plot(data$yday[row_ids[,k]][1:N], data$mean_temp[row_ids[,k]][1:N], cex=.25)
+   plot(data$yday[row_ids[,k]][1:N], data$ctemp[row_ids[,k]][1:N], cex=.25)
+ }
> 
> 
> 
> # Compute pseudo-observations using ECDF ----------------------------------
> data <- data %>% mutate(pseudo_temp = NA, diff = NA, w1 = NA, w = NA)
> for(k in 1:p){
+   id <- stns_id[k]
+   cat("Working on ECDF for station ", id, ".\n")
+   row_id <- row_ids[,k]
+   
+   for(tt in 1:366){
+     if(tt %% 20 == 0) cat("progess: ", round(tt/366*100,2), "%\n")
+     
+     # construct weights based on yday using gaussian kernel
+     data[row_id,] <- data[row_id,] %>%
+       mutate(diff = tt - (time %% year_len)) %>%
+       mutate(diff = abs(pmin(diff, year_len - diff))) %>%
+       mutate(w1 = dnorm(diff,0,1)) %>%
+       mutate(w = w1/sum(w1, na.rm = T)) 
+     
+     # construct ecdf function using all the data
+     wecdf <- spatstat.geom::ewcdf(data[row_id,]$ctemp, data[row_id,]$w)
+     
+     # compute ecdf only for yday we care for
+     ind <- which(data[row_id,]$yday == tt & !is.na(data[row_id,]$ctemp))
+     data[row_id,][ind,] <- data[row_id,][ind,] %>%
+       mutate(pseudo_temp = wecdf(ctemp))
+     
+     # heuristic correction for the largest (pseudo_obs = 1)
+     # to avoid modifying all values (say, with pseudo_obs = pseudo_obs*n_ind/(n_ind+1))
+     n_ind <- length(ind)
+     data[row_id,][ind,] <- data[row_id,][ind,] %>%
+       mutate(pseudo_temp = ifelse(pseudo_temp == 1, 1-1/(2*n_ind), pseudo_temp))
+   }
+ }
Working on ECDF for station  568 .
progess:  5.46 %
progess:  10.93 %
progess:  16.39 %
progess:  21.86 %
progess:  27.32 %
progess:  32.79 %
progess:  38.25 %
progess:  43.72 %
progess:  49.18 %
progess:  54.64 %
progess:  60.11 %
progess:  65.57 %
progess:  71.04 %
progess:  76.5 %
progess:  81.97 %
progess:  87.43 %
progess:  92.9 %
progess:  98.36 %
Working on ECDF for station  4333 .
progess:  5.46 %
progess:  10.93 %
progess:  16.39 %
progess:  21.86 %
progess:  27.32 %
progess:  32.79 %
progess:  38.25 %
progess:  43.72 %
progess:  49.18 %
progess:  54.64 %
progess:  60.11 %
progess:  65.57 %
progess:  71.04 %
progess:  76.5 %
progess:  81.97 %
progess:  87.43 %
progess:  92.9 %
progess:  98.36 %
Working on ECDF for station  5051 .
progess:  5.46 %
progess:  10.93 %
progess:  16.39 %
progess:  21.86 %
progess:  27.32 %
progess:  32.79 %
progess:  38.25 %
progess:  43.72 %
progess:  49.18 %
progess:  54.64 %
progess:  60.11 %
progess:  65.57 %
progess:  71.04 %
progess:  76.5 %
progess:  81.97 %
progess:  87.43 %
progess:  92.9 %
progess:  98.36 %
> 
> 
> 
> # resulting histograms are even better than expected
> ggplot(data, aes(x = pseudo_temp, fill=as.factor(yday))) +
+   theme(legend.position = "none") +
+   geom_histogram(breaks=seq(0,1,.05), position = position_stack()) +
+   facet_wrap(~station_name)
Warning message:
Removed 12480 rows containing non-finite values (stat_bin). 
> 
> # quick check of the other operations (tt = 366, last it. of for loop)
> s <- sample(nrow(data) - 1000,1)
> par(mfrow=c(3,1))
> plot(data$pseudo_temp[s + 1:100], type="o") # makes sense
> plot(data$date[s + 1:1000], data$diff[s + 1:1000]) # linear in time, as expected
> plot(data$date[s + 1:1000], data$w[s + 1:1000], type="l") # select only end of year periods
> 
> # note that there are equalities, but very very few of them. can disregard.
> apply(row_ids, 2, \(r){
+   tab <- table(data[r,]$pseudo_temp)
+   tab[tab > 1]
+ })
[[1]]

0.197789548911502 0.202483435594215 0.242742352470637 0.302731488965765 
                2                 2                 2                 2 
0.326080520631035 0.510389030465614 0.568831289929138 0.703641956831544 
                2                 2                 2                 2 
0.708333777580254 0.861944858943431 0.995867768595041 0.995901639344262 
                2                 2                 3                 6 
0.995934959349594 0.995967741935484             0.996 
                4                 6                 3 

[[2]]

0.0449576338904751  0.733968269044897  0.805067027044066  0.996212121212121 
                 2                  2                  2                  4 
 0.996240601503759  0.996268656716418                  1 
                 9                  8                  3 

[[3]]

0.320339263447646 0.329269689147573 0.348869862941482 0.551801525553297 
                2                 2                 2                 2 
0.645918337433233 0.996932515337423 0.996951219512195                 1 
                2                16                 7                 3 

> 
> 
> 
> # Save for later use ------------------------------------------------------
> saveRDS(data, "app/data/data_pp6.rds")
> 
> proc.time()
    user   system  elapsed 
1537.460    9.418 1547.082 
