
R version 4.2.1 (2022-06-23) -- "Funny-Looking Kid"
Copyright (C) 2022 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> # Preprocessing of the raw data
> # launched with 
> # R CMD BATCH --vanilla --no-restore app/preprocessing.R app/log_pp.txt
> 
> # packages ----------------------------------------------------------------
> library(tidyverse)
── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──
✔ ggplot2 3.3.6     ✔ purrr   0.3.4
✔ tibble  3.1.8     ✔ dplyr   1.1.0
✔ tidyr   1.2.1     ✔ stringr 1.4.1
✔ readr   2.1.2     ✔ forcats 0.5.2
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
> library(lubridate)

Attaching package: ‘lubridate’

The following objects are masked from ‘package:base’:

    date, intersect, setdiff, union

> library(lunar)
> library(ggplot2)
> library(spatstat.geom) # weighted ecdf
Loading required package: spatstat.data
spatstat.geom 3.2-4
> 
> 
> 
> # load and preprocess data ------------------------------------------------
> stns_id <- readRDS("app/data/stns_id.rds")
> weathercan::stations() %>% filter(station_id %in% stns_id, interval == "day") %>%
+   print(nrow = nrow(.))
The stations data frame hasn't been updated in over 4 weeks. Consider running `stations_dl()` to check for updates and make sure you have the most recent stations list available
# A tibble: 8 × 16
  prov  station…¹ stati…² clima…³ WMO_id TC_id   lat    lon   elev tz    inter…⁴
  <chr> <chr>       <dbl> <chr>    <dbl> <chr> <dbl>  <dbl>  <dbl> <chr> <chr>  
1 BC    QUATSINO      271 1036570     NA <NA>   50.5 -128.  3.42e0 Etc/… day    
2 BC    BARKERVI…     568 1090660     NA <NA>   53.1 -122.  1.28e3 Etc/… day    
3 BC    AGASSIZ …     707 1100120     NA <NA>   49.2 -122.  1.5 e1 Etc/… day    
4 ON    OTTAWA C…    4333 6105976     NA WCG    45.4  -75.7 7.92e1 Etc/… day    
5 ON    WELLAND      4712 6139445     NA <NA>   43.0  -79.3 1.75e2 Etc/… day    
6 ON    BELLEVIL…    4859 6150689     NA <NA>   44.2  -77.4 7.62e1 Etc/… day    
7 ON    BLOOMFIE…    4862 6150815     NA <NA>   44.0  -77.2 9.14e1 Etc/… day    
8 ON    TORONTO      5051 6158350  71266 <NA>   43.7  -79.4 1.12e2 Etc/… day    
# … with 5 more variables: start <dbl>, end <dbl>, normals <lgl>,
#   normals_1981_2010 <lgl>, normals_1971_2000 <lgl>, and abbreviated variable
#   names ¹​station_name, ²​station_id, ³​climate_id, ⁴​interval
> 
> filepaths <- paste0("app/data/daily_data_", stns_id, ".rds")
> data <- lapply(filepaths, readRDS) |> dplyr::bind_rows()
> str(data)
tibble [421,408 × 37] (S3: tbl_df/tbl/data.frame)
 $ station_name      : chr [1:421408] "QUATSINO" "QUATSINO" "QUATSINO" "QUATSINO" ...
 $ station_id        : num [1:421408] 271 271 271 271 271 271 271 271 271 271 ...
 $ station_operator  : logi [1:421408] NA NA NA NA NA NA ...
 $ prov              : chr [1:421408] "BC" "BC" "BC" "BC" ...
 $ lat               : num [1:421408] 50.5 50.5 50.5 50.5 50.5 ...
 $ lon               : num [1:421408] -128 -128 -128 -128 -128 ...
 $ elev              : num [1:421408] 3.4 3.4 3.4 3.4 3.4 3.4 3.4 3.4 3.4 3.4 ...
 $ climate_id        : chr [1:421408] "1036570" "1036570" "1036570" "1036570" ...
 $ WMO_id            : chr [1:421408] NA NA NA NA ...
 $ TC_id             : chr [1:421408] NA NA NA NA ...
 $ date              : Date[1:421408], format: "1895-01-01" "1895-01-02" ...
 $ year              : chr [1:421408] "1895" "1895" "1895" "1895" ...
 $ month             : chr [1:421408] "01" "01" "01" "01" ...
 $ day               : chr [1:421408] "01" "02" "03" "04" ...
 $ qual              : chr [1:421408] NA NA NA NA ...
 $ cool_deg_days     : num [1:421408] NA NA NA NA NA NA NA NA NA NA ...
 $ cool_deg_days_flag: chr [1:421408] NA NA NA NA ...
 $ dir_max_gust      : num [1:421408] NA NA NA NA NA NA NA NA NA NA ...
 $ dir_max_gust_flag : chr [1:421408] NA NA NA NA ...
 $ heat_deg_days     : num [1:421408] NA NA NA NA NA NA NA NA NA NA ...
 $ heat_deg_days_flag: chr [1:421408] NA NA NA NA ...
 $ max_temp          : num [1:421408] NA NA NA NA NA NA NA NA NA NA ...
 $ max_temp_flag     : chr [1:421408] NA NA NA NA ...
 $ mean_temp         : num [1:421408] NA NA NA NA NA NA NA NA NA NA ...
 $ mean_temp_flag    : chr [1:421408] NA NA NA NA ...
 $ min_temp          : num [1:421408] NA NA NA NA NA NA NA NA NA NA ...
 $ min_temp_flag     : chr [1:421408] NA NA NA NA ...
 $ snow_grnd         : num [1:421408] NA NA NA NA NA NA NA NA NA NA ...
 $ snow_grnd_flag    : chr [1:421408] NA NA NA NA ...
 $ spd_max_gust      : num [1:421408] NA NA NA NA NA NA NA NA NA NA ...
 $ spd_max_gust_flag : chr [1:421408] NA NA NA NA ...
 $ total_precip      : num [1:421408] NA NA NA NA NA NA NA NA NA NA ...
 $ total_precip_flag : chr [1:421408] NA NA NA NA ...
 $ total_rain        : num [1:421408] NA NA NA NA NA NA NA NA NA NA ...
 $ total_rain_flag   : chr [1:421408] NA NA NA NA ...
 $ total_snow        : num [1:421408] NA NA NA NA NA NA NA NA NA NA ...
 $ total_snow_flag   : chr [1:421408] NA NA NA NA ...
> 
> # time variables setup
> data <- data %>% mutate(date = as.Date(date),
+                         year = as.integer(year),
+                         month = as.integer(month),
+                         day = as.integer(day))
> 
> data <- data %>% mutate(time = as.integer(date),
+                         yday = lubridate::yday(date),
+                         week = lubridate::week(date))
> 
> # stations we look at
> stns_id <- c(568, 4333, 5051)
> p <- 3
> data <- data %>%
+   filter(station_id %in% stns_id) %>%
+   arrange(station_id, date)
> 
> # quick look at summary of the data (clearly shows time trends)
> data0 <- data %>% group_by(station_name, year) %>%
+   summarise(mm_temp = mean(mean_temp, na.rm=T))
`summarise()` has grouped output by 'station_name'. You can override using the
`.groups` argument.
> ggplot(data0, aes(x=year, y=mm_temp)) +
+   geom_line() +
+   geom_point() +
+   facet_wrap(~station_name)
Warning messages:
1: Removed 20 row(s) containing missing values (geom_path). 
2: Removed 25 rows containing missing values (geom_point). 
> 
> 
> # Estimate mean conditional on time of year -------------------------------
> year_len <- 365 + 6/24 + 9/60/24 + 9/60^2/24
> 
> # create sines-cosines basis (for seasonal trend)
> nSC <- 12
> s_cols <- paste0("s", 1:nSC)
> c_cols <- paste0("c", 1:nSC)
> for (i in 1:nSC) data <- data %>%
+   mutate(!!s_cols[i] := sin(i*2*pi*time/year_len),
+          !!c_cols[i] := cos(i*2*pi*time/year_len))
> 
> 
> # create natural spline basis (for long term time trend)
> # for this check range for each station
> row_ids <- sapply(stns_id, \(id) data$station_id == id)
> bss <- lapply(1:p, \(k){
+   data[row_ids[,k],] %>% filter(day == 21, month %in% c(6,12)) %>% select(time) %>% unlist
+ })
> 
> for(b in paste("b", 1:max(sapply(bss, length)))) data <- data %>% mutate(!!b := NA)
> nB <- rep(0, p); b_cols <- list()
> for(k in 1:p){
+   B <- splines::bs(data[row_ids[,k],]$time, knots = c(bss[[k]]), degree = 2)
+   B <- B[,colSums(abs(B[!is.na(data[row_ids[,k],]$mean_temp),])) > 1e-5]
+   nB[k] <- ncol(B)
+   b_cols[[length(b_cols)+1]] <- paste0("b", 1:nB[k])
+   data[row_ids[,k],b_cols[[k]]] <- B
+   rm(B)
+ }
> 
> 
> # fit least-squares
> non_na <- !is.na(data$mean_temp) # for later
> lms <- lapply(1:p, \(k){
+   x_cols <- c("mean_temp", s_cols, c_cols, b_cols[[k]])
+   lm(formula = "mean_temp~.", data = data[row_ids[,k],x_cols])
+ })
> 
> # Bakerville
> summary(lms[[1]])

Call:
lm(formula = "mean_temp~.", data = data[row_ids[, k], x_cols])

Residuals:
     Min       1Q   Median       3Q      Max 
-31.6158  -2.4372   0.2571   2.9784  18.6475 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)   9.144791   2.125927   4.302 1.70e-05 ***
s1           -8.895382   3.805822  -2.337 0.019428 *  
s2            0.571213   0.031700  18.019  < 2e-16 ***
s3           -0.115987   0.124695  -0.930 0.352292    
s4            0.232343   0.031475   7.382 1.59e-13 ***
s5           -0.209697   0.036194  -5.794 6.93e-09 ***
s6           -0.095197   0.031458  -3.026 0.002478 ** 
s7           -0.076156   0.031558  -2.413 0.015816 *  
s8            0.003657   0.031442   0.116 0.907417    
s9           -0.036338   0.031441  -1.156 0.247779    
s10           0.065835   0.031415   2.096 0.036120 *  
s11           0.069705   0.031440   2.217 0.026623 *  
s12           0.004696   0.031403   0.150 0.881126    
c1          -11.334013   0.736100 -15.397  < 2e-16 ***
c2           -0.317000   0.031683 -10.006  < 2e-16 ***
c3           -0.144785   0.083992  -1.724 0.084751 .  
c4           -0.117455   0.031505  -3.728 0.000193 ***
c5            0.112811   0.040361   2.795 0.005192 ** 
c6           -0.127739   0.031445  -4.062 4.87e-05 ***
c7           -0.081322   0.033311  -2.441 0.014639 *  
c8           -0.086809   0.031420  -2.763 0.005732 ** 
c9           -0.011551   0.031867  -0.362 0.717004    
c10           0.031668   0.031424   1.008 0.313567    
c11          -0.010779   0.031527  -0.342 0.732426    
c12          -0.106173   0.031427  -3.378 0.000730 ***
b1            2.690416   6.219911   0.433 0.665345    
b2          -15.934213   8.729509  -1.825 0.067958 .  
b3            5.196941   6.629915   0.784 0.433125    
b4          -17.033080   8.849522  -1.925 0.054268 .  
b5            2.344025   6.627452   0.354 0.723577    
b6          -16.214682   8.858967  -1.830 0.067210 .  
b7            2.511197   6.637326   0.378 0.705176    
b8          -16.367810   8.854688  -1.848 0.064538 .  
b9            2.766624   6.641934   0.417 0.677018    
b10         -16.848028   8.846214  -1.905 0.056845 .  
b11           2.561963   6.642952   0.386 0.699746    
b12         -18.204759   8.886786  -2.049 0.040515 *  
b13           3.599550   6.634049   0.543 0.587417    
b14         -17.303838   8.865168  -1.952 0.050957 .  
b15           4.292102   6.636106   0.647 0.517778    
b16         -17.870492   8.848897  -2.020 0.043440 *  
b17           3.871038   6.625567   0.584 0.559050    
b18         -18.554940   8.849172  -2.097 0.036017 *  
b19           4.338993   6.638847   0.654 0.513388    
b20         -17.239937   8.873503  -1.943 0.052040 .  
b21           5.169727   6.651290   0.777 0.437014    
b22         -16.372951   8.868967  -1.846 0.064885 .  
b23           0.614812   6.646903   0.092 0.926304    
b24         -17.243468   8.876267  -1.943 0.052065 .  
b25           7.467920   6.650588   1.123 0.261488    
b26         -19.432428   8.878088  -2.189 0.028616 *  
b27           4.302756   6.651248   0.647 0.517694    
b28         -17.239184   8.877887  -1.942 0.052166 .  
b29           5.757938   6.649821   0.866 0.386561    
b30         -19.952831   8.873947  -2.248 0.024551 *  
b31           4.320128   6.640511   0.651 0.515326    
b32         -19.097003   8.851618  -2.157 0.030975 *  
b33           2.961674   6.627586   0.447 0.654971    
b34         -17.151417   8.851379  -1.938 0.052665 .  
b35           6.628604   6.640038   0.998 0.318150    
b36         -20.279621   8.872987  -2.286 0.022285 *  
b37           7.407243   6.647855   1.114 0.265186    
b38         -19.175698   8.873342  -2.161 0.030697 *  
b39           0.265786   6.651048   0.040 0.968124    
b40         -15.651418   8.852994  -1.768 0.077081 .  
b41           2.745486   6.628145   0.414 0.678718    
b42         -17.434746   8.851466  -1.970 0.048879 *  
b43           2.731188   6.640099   0.411 0.680842    
b44         -21.299865   8.872990  -2.401 0.016375 *  
b45           4.682413   6.647767   0.704 0.481213    
b46         -20.664198   8.873045  -2.329 0.019870 *  
b47           3.440334   6.640131   0.518 0.604382    
b48         -20.939015   8.851456  -2.366 0.018005 *  
b49           5.551674   6.627531   0.838 0.402221    
b50         -19.701395   8.851378  -2.226 0.026033 *  
b51           2.400300   6.640046   0.361 0.717736    
b52         -19.237068   8.872991  -2.168 0.030160 *  
b53           5.891470   6.647764   0.886 0.375497    
b54         -20.942630   8.873047  -2.360 0.018267 *  
b55           8.602413   6.640129   1.296 0.195148    
b56         -20.640712   8.851457  -2.332 0.019710 *  
b57           1.479965   6.627538   0.223 0.823299    
b58         -18.518161   8.851392  -2.092 0.036434 *  
b59           0.258367   6.640060   0.039 0.968962    
b60         -17.432922   8.873004  -1.965 0.049453 *  
b61           3.072853   6.647770   0.462 0.643913    
b62         -17.412504   8.873049  -1.962 0.049722 *  
b63           3.656875   6.640127   0.551 0.581826    
b64         -20.687470   8.851458  -2.337 0.019434 *  
b65           3.146546   6.627544   0.475 0.634955    
b66         -19.473445   8.851405  -2.200 0.027809 *  
b67           4.983236   6.640074   0.750 0.452970    
b68         -20.488599   8.873014  -2.309 0.020943 *  
b69           1.692303   6.647776   0.255 0.799059    
b70         -17.534442   8.873050  -1.976 0.048144 *  
b71           2.875704   6.640124   0.433 0.664959    
b72         -16.666612   8.851457  -1.883 0.059717 .  
b73           5.213866   6.627548   0.787 0.431464    
b74         -20.176454   8.851417  -2.279 0.022644 *  
b75           5.138885   6.640086   0.774 0.438983    
b76         -19.597209   8.873025  -2.209 0.027206 *  
b77           9.262604   6.647781   1.393 0.163525    
b78         -21.337166   8.873054  -2.405 0.016189 *  
b79           5.271981   6.640128   0.794 0.427224    
b80         -20.772013   8.851478  -2.347 0.018943 *  
b81           4.700188   6.627605   0.709 0.478214    
b82         -17.997002   8.851581  -2.033 0.042039 *  
b83           2.328511   6.640540   0.351 0.725852    
b84         -18.274394   8.872979  -2.060 0.039447 *  
b85           2.196069   6.647755   0.330 0.741139    
b86         -17.509870   8.873034  -1.973 0.048458 *  
b87           7.047791   6.640109   1.061 0.288515    
b88         -20.315067   8.851448  -2.295 0.021731 *  
b89           3.902909   6.627554   0.589 0.555937    
b90         -18.614079   8.851440  -2.103 0.035476 *  
b91           5.485505   6.640115   0.826 0.408743    
b92         -22.939123   8.873066  -2.585 0.009734 ** 
b93           8.512912   6.647839   1.281 0.200357    
b94         -21.776194   8.873201  -2.454 0.014125 *  
b95           2.111810   6.640462   0.318 0.750470    
b96         -18.177709   8.852471  -2.053 0.040039 *  
b97           1.016474   6.630312   0.153 0.878157    
b98         -18.313081   8.850686  -2.069 0.038541 *  
b99           0.895401   6.639721   0.135 0.892727    
b100        -16.067351   8.872782  -1.811 0.070170 .  
b101          4.400377   6.647680   0.662 0.508012    
b102        -17.461902   8.872988  -1.968 0.049076 *  
b103          3.254313   6.640078   0.490 0.624064    
b104        -17.826687   8.851428  -2.014 0.044017 *  
b105          6.083509   6.627548   0.918 0.358670    
b106        -20.830567   8.851447  -2.353 0.018609 *  
b107          8.793949   6.640118   1.324 0.185388    
b108        -20.784734   8.873047  -2.342 0.019162 *  
b109          4.373672   6.647780   0.658 0.510596    
b110        -18.943366   8.873034  -2.135 0.032772 *  
b111          0.391793   6.640089   0.059 0.952949    
b112        -17.633434   8.851432  -1.992 0.046360 *  
b113          4.442541   6.627554   0.670 0.502661    
b114        -17.835388   8.851464  -2.015 0.043914 *  
b115          4.412313   6.640146   0.664 0.506380    
b116        -22.050444   8.873109  -2.485 0.012956 *  
b117          6.186766   6.647903   0.931 0.352048    
b118        -22.429337   8.873360  -2.528 0.011484 *  
b119          6.446639   6.640840   0.971 0.331675    
b120        -19.538564   8.853564  -2.207 0.027329 *  
b121          4.126882   6.634164   0.622 0.533902    
b122        -16.941147   8.874571  -1.909 0.056274 .  
b123         -6.526798   6.881001  -0.949 0.342868    
b124         27.109058  90.045294   0.301 0.763370    
b125        -50.395782  28.249163  -1.784 0.074435 .  
b126        -19.866145   9.000411  -2.207 0.027302 *  
b127          1.624114   6.659789   0.244 0.807334    
b128        -15.905794   8.860905  -1.795 0.072652 .  
b129          2.641966   6.643885   0.398 0.690887    
b130        -16.209076   8.874483  -1.826 0.067784 .  
b131         -0.023737   6.648388  -0.004 0.997151    
b132        -17.194519   8.873262  -1.938 0.052655 .  
b133          2.762914   6.640163   0.416 0.677345    
b134        -22.079849   8.851443  -2.494 0.012617 *  
b135          2.118206   6.627554   0.320 0.749269    
b136        -19.074506   8.851466  -2.155 0.031171 *  
b137          1.853775   6.640133   0.279 0.780110    
b138        -19.037787   8.873050  -2.146 0.031912 *  
b139          7.890803   6.647759   1.187 0.235239    
b140        -19.334236   8.872996  -2.179 0.029337 *  
b141          4.067910   6.640035   0.613 0.540122    
b142        -20.734571   8.851383  -2.343 0.019158 *  
b143          3.993882   6.627525   0.603 0.546764    
b144        -19.485399   8.851457  -2.201 0.027714 *  
b145          6.967531   6.640128   1.049 0.294043    
b146        -19.802613   8.873045  -2.232 0.025635 *  
b147          1.487225   6.647752   0.224 0.822977    
b148        -16.852781   8.872987  -1.899 0.057527 .  
b149          4.212395   6.640030   0.634 0.525827    
b150        -18.004650   8.851396  -2.034 0.041947 *  
b151          3.574219   6.627607   0.539 0.589688    
b152        -20.984268   8.851748  -2.371 0.017762 *  
b153          1.935415   6.643504   0.291 0.770805    
b154        -18.053332   8.873501  -2.035 0.041905 *  
b155          2.294665   6.648051   0.345 0.729973    
b156        -18.067699   8.873019  -2.036 0.041731 *  
b157          2.817228   6.640019   0.424 0.671364    
b158        -17.936756   8.851358  -2.026 0.042726 *  
b159          5.367702   6.627508   0.810 0.417995    
b160        -22.120229   8.851451  -2.499 0.012456 *  
b161          2.639981   6.640123   0.398 0.690942    
b162        -17.381747   8.873034  -1.959 0.050126 .  
b163          5.098567   6.647728   0.767 0.443107    
b164        -20.851038   8.872951  -2.350 0.018780 *  
b165          4.271575   6.639980   0.643 0.520025    
b166        -20.024380   8.851332  -2.262 0.023684 *  
b167          1.659024   6.627491   0.250 0.802337    
b168        -20.251072   8.851442  -2.288 0.022149 *  
b169          4.633274   6.640111   0.698 0.485324    
b170        -20.674656   8.873013  -2.330 0.019807 *  
b171          2.793830   6.647682   0.420 0.674289    
b172        -17.461165   8.872864  -1.968 0.049082 *  
b173          0.645262   6.639797   0.097 0.922583    
b174        -17.753064   8.850995  -2.006 0.044887 *  
b175          4.584015   6.626964   0.692 0.489116    
b176        -18.378325   8.850215  -2.077 0.037845 *  
b177          7.368793   6.637016   1.110 0.266894    
b178        -21.671319   8.866103  -2.444 0.014518 *  
b179          3.367857   6.635559   0.508 0.611774    
b180        -14.598240   8.861747  -1.647 0.099497 .  
b181          2.429145   6.754664   0.360 0.719129    
b182        -16.391182   8.881727  -1.845 0.064972 .  
b183          3.880977   6.639686   0.585 0.558879    
b184        -18.053573   8.856215  -2.039 0.041504 *  
b185          6.298555   6.642143   0.948 0.342996    
b186        -18.159570   8.873801  -2.046 0.040720 *  
b187          1.993212   6.647953   0.300 0.764313    
b188        -18.618154   8.874284  -2.098 0.035912 *  
b189          7.362645   6.639619   1.109 0.267481    
b190        -21.125546   8.849828  -2.387 0.016985 *  
b191          6.695886   6.627417   1.010 0.312342    
b192        -22.568150   8.851502  -2.550 0.010787 *  
b193          5.350268   6.640735   0.806 0.420435    
b194        -21.898199   8.876883  -2.467 0.013633 *  
b195          5.051426   6.647845   0.760 0.447343    
b196        -19.493624   8.872885  -2.197 0.028026 *  
b197          7.481680   6.639879   1.127 0.259842    
b198        -18.720849   8.851233  -2.115 0.034431 *  
b199          4.769144   6.627473   0.720 0.471774    
b200        -18.401125   8.852087  -2.079 0.037648 *  
b201          2.697205   6.640123   0.406 0.684599    
b202        -17.478788   8.872958  -1.970 0.048857 *  
b203          5.240532   6.647630   0.788 0.430507    
b204        -19.738180   8.872872  -2.225 0.026116 *  
b205          4.108796   6.639867   0.619 0.536047    
b206        -19.193320   8.851444  -2.168 0.030135 *  
b207          9.663610   6.627459   1.458 0.144815    
b208        -21.547502   8.851358  -2.434 0.014922 *  
b209          4.507774   6.639940   0.679 0.497213    
b210        -18.491318   8.872633  -2.084 0.037158 *  
b211          6.194370   6.646883   0.932 0.351382    
b212        -19.320295   8.871077  -2.178 0.029419 *  
b213          5.254546   6.636349   0.792 0.428492    
b214        -19.106584   8.844434  -2.160 0.030755 *  
b215          1.823935   6.639404   0.275 0.783538    
b216        -20.491924   8.846651  -2.316 0.020544 *  
b217          3.308209   6.637980   0.498 0.618222    
b218        -18.710355   8.871828  -2.109 0.034953 *  
b219          6.805168   6.647397   1.024 0.305966    
b220        -17.717427   8.872609  -1.997 0.045846 *  
b221          3.776477   6.639703   0.569 0.569514    
b222        -18.567036   8.851429  -2.098 0.035943 *  
b223          4.409001   6.627563   0.665 0.505893    
b224        -19.200238   8.851381  -2.169 0.030074 *  
b225          3.639760   6.640228   0.548 0.583600    
b226        -17.916595   8.872938  -2.019 0.043468 *  
b227          1.620800   6.647510   0.244 0.807371    
b228        -17.947116   8.872962  -2.023 0.043113 *  
b229          6.333783   6.639587   0.954 0.340118    
b230        -20.588205   8.850542  -2.326 0.020012 *  
b231          6.536179   6.626246   0.986 0.323939    
b232        -19.755057   8.849778  -2.232 0.025602 *  
b233          6.302285   6.642623   0.949 0.342745    
b234        -19.894400   8.873246  -2.242 0.024962 *  
b235          6.145383   6.646071   0.925 0.355146    
b236        -19.248370   8.868553  -2.170 0.029981 *  
b237          5.426817   6.632091   0.818 0.413209    
b238        -18.930987   8.852905  -2.138 0.032490 *  
b239          2.443834   6.636977   0.368 0.712715    
b240        -18.038420   8.856871  -2.037 0.041690 *  
b241          0.501664   6.638336   0.076 0.939761    
b242        -14.171490   8.878839  -1.596 0.110474    
b243          6.204070   6.643617   0.934 0.350392    
b244        -20.492235   8.866696  -2.311 0.020829 *  
b245          1.852885   6.666845   0.278 0.781071    
b246        -18.707635   8.872056  -2.109 0.034985 *  
b247          3.625543   6.648608   0.545 0.585544    
b248        -17.371687   8.855916  -1.962 0.049816 *  
b249          4.151319   6.645397   0.625 0.532177    
b250        -16.623430   8.870684  -1.874 0.060941 .  
b251          2.001840   6.628007   0.302 0.762633    
b252        -17.160113   8.854664  -1.938 0.052633 .  
b253          7.391588   6.633713   1.114 0.265180    
b254          3.716032  14.571653   0.255 0.798710    
b255        -27.707426  21.054174  -1.316 0.188179    
b256        -16.659698   9.026032  -1.846 0.064937 .  
b257          3.850858   6.681683   0.576 0.564395    
b258        -17.229993   8.881778  -1.940 0.052395 .  
b259          1.806713   6.641322   0.272 0.785592    
b260        -16.103505   8.846102  -1.820 0.068704 .  
b261          1.077922   6.587104   0.164 0.870014    
b262         -4.444560   3.393473  -1.310 0.190291    
b263          9.133458  87.488605   0.104 0.916856    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 4.707 on 44631 degrees of freedom
  (4601 observations deleted due to missingness)
Multiple R-squared:  0.7266,	Adjusted R-squared:  0.7248 
F-statistic: 413.2 on 287 and 44631 DF,  p-value: < 2.2e-16

> # Ottawa
> summary(lms[[2]])

Call:
lm(formula = "mean_temp~.", data = data[row_ids[, k], x_cols])

Residuals:
     Min       1Q   Median       3Q      Max 
-21.8133  -3.0110  -0.0292   3.0438  18.3830 

Coefficients: (1 not defined because of singularities)
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)   3.047587   8.485595   0.359 0.719486    
s1          -33.335528   3.796668  -8.780  < 2e-16 ***
s2           -1.048633   0.030309 -34.598  < 2e-16 ***
s3           -1.229194   0.123753  -9.933  < 2e-16 ***
s4            0.162286   0.030253   5.364 8.16e-08 ***
s5            0.029469   0.035084   0.840 0.400940    
s6            0.091411   0.030260   3.021 0.002522 ** 
s7            0.067349   0.030363   2.218 0.026548 *  
s8            0.100488   0.030248   3.322 0.000894 ***
s9            0.029287   0.030264   0.968 0.333195    
s10          -0.002214   0.030249  -0.073 0.941654    
s11          -0.041624   0.030283  -1.375 0.169290    
s12          -0.125290   0.030244  -4.143 3.44e-05 ***
c1          -20.376094   0.738268 -27.600  < 2e-16 ***
c2           -0.749029   0.030424 -24.620  < 2e-16 ***
c3           -0.635094   0.083624  -7.595 3.14e-14 ***
c4           -0.050313   0.030278  -1.662 0.096573 .  
c5           -0.244911   0.039380  -6.219 5.04e-10 ***
c6            0.169568   0.030249   5.606 2.08e-08 ***
c7            0.019944   0.032168   0.620 0.535256    
c8            0.022435   0.030254   0.742 0.458352    
c9            0.007437   0.030698   0.242 0.808584    
c10           0.029487   0.030248   0.975 0.329638    
c11          -0.052463   0.030353  -1.728 0.083918 .  
c12           0.033107   0.030250   1.094 0.273772    
b1          -88.256536  55.837006  -1.581 0.113974    
b2          -44.335744   9.314873  -4.760 1.94e-06 ***
b3           55.167057  12.912624   4.272 1.94e-05 ***
b4          -52.824210   9.353719  -5.647 1.64e-08 ***
b5           56.169061  12.984600   4.326 1.52e-05 ***
b6          -50.685847   9.364441  -5.413 6.24e-08 ***
b7           56.945658  12.989368   4.384 1.17e-05 ***
b8          -52.562857   9.368440  -5.611 2.03e-08 ***
b9           54.845297  13.002184   4.218 2.47e-05 ***
b10         -52.341089   9.380589  -5.580 2.42e-08 ***
b11          58.005334  13.009328   4.459 8.26e-06 ***
b12         -52.441031   9.381019  -5.590 2.28e-08 ***
b13          57.506230  13.003524   4.422 9.78e-06 ***
b14         -52.852863   9.369863  -5.641 1.70e-08 ***
b15          57.180317  12.993101   4.401 1.08e-05 ***
b16         -52.439077   9.369703  -5.597 2.20e-08 ***
b17          58.224567  13.003658   4.478 7.57e-06 ***
b18         -53.359049   9.382011  -5.687 1.30e-08 ***
b19          59.725088  13.013620   4.589 4.46e-06 ***
b20         -51.702548   9.387944  -5.507 3.66e-08 ***
b21          56.439152  13.026946   4.332 1.48e-05 ***
b22         -51.063830   9.384051  -5.442 5.31e-08 ***
b23          57.014839  13.013277   4.381 1.18e-05 ***
b24         -51.077950   9.384536  -5.443 5.27e-08 ***
b25          57.582594  13.013770   4.425 9.68e-06 ***
b26         -52.202775   9.384441  -5.563 2.67e-08 ***
b27          59.237733  13.012620   4.552 5.32e-06 ***
b28         -54.650628   9.382397  -5.825 5.75e-09 ***
b29          60.979130  13.005036   4.689 2.75e-06 ***
b30         -55.133457   9.370739  -5.884 4.04e-09 ***
b31          55.924752  12.994468   4.304 1.68e-05 ***
b32         -53.737068   9.370597  -5.735 9.83e-09 ***
b33          54.761645  13.004611   4.211 2.55e-05 ***
b34         -51.654751   9.381875  -5.506 3.69e-08 ***
b35          57.736778  13.010932   4.438 9.12e-06 ***
b36         -51.653343   9.381925  -5.506 3.70e-08 ***
b37          54.174139  13.004726   4.166 3.11e-05 ***
b38         -52.426860   9.370655  -5.595 2.22e-08 ***
b39          55.817319  12.994421   4.295 1.75e-05 ***
b40         -50.103911   9.370592  -5.347 8.99e-08 ***
b41          56.201551  13.004617   4.322 1.55e-05 ***
b42         -52.661996   9.381881  -5.613 2.00e-08 ***
b43          60.883326  13.010940   4.679 2.89e-06 ***
b44         -54.443664   9.381929  -5.803 6.55e-09 ***
b45          57.350913  13.004730   4.410 1.04e-05 ***
b46         -50.501567   9.370659  -5.389 7.11e-08 ***
b47          54.134012  12.994431   4.166 3.11e-05 ***
b48         -50.948373   9.370602  -5.437 5.44e-08 ***
b49          58.225209  13.004633   4.477 7.58e-06 ***
b50         -51.281424   9.381891  -5.466 4.63e-08 ***
b51          57.102718  13.010949   4.389 1.14e-05 ***
b52         -52.501639   9.381933  -5.596 2.20e-08 ***
b53          58.678961  13.004732   4.512 6.43e-06 ***
b54         -51.331853   9.370662  -5.478 4.32e-08 ***
b55          55.960162  12.994439   4.306 1.66e-05 ***
b56         -50.984148   9.370611  -5.441 5.33e-08 ***
b57          55.089238  13.004648   4.236 2.28e-05 ***
b58         -53.804571   9.381899  -5.735 9.81e-09 ***
b59          55.489442  13.010957   4.265 2.00e-05 ***
b60         -52.004739   9.381936  -5.543 2.99e-08 ***
b61          59.529056  13.004734   4.577 4.72e-06 ***
b62         -53.105711   9.370664  -5.667 1.46e-08 ***
b63          56.069343  12.994446   4.315 1.60e-05 ***
b64         -51.303760   9.370619  -5.475 4.40e-08 ***
b65          61.296651  13.004660   4.713 2.44e-06 ***
b66         -52.369088   9.381906  -5.582 2.39e-08 ***
b67          58.061806  13.010959   4.463 8.12e-06 ***
b68         -51.053703   9.381944  -5.442 5.30e-08 ***
b69          53.559922  13.004738   4.118 3.82e-05 ***
b70         -50.015882   9.370671  -5.337 9.47e-08 ***
b71          56.637636  12.994459   4.359 1.31e-05 ***
b72         -53.278991   9.370628  -5.686 1.31e-08 ***
b73          58.503201  13.004675   4.499 6.86e-06 ***
b74         -53.398300   9.381913  -5.692 1.27e-08 ***
b75          55.192484  13.010970   4.242 2.22e-05 ***
b76         -53.893609   9.381940  -5.744 9.28e-09 ***
b77          57.659922  13.004734   4.434 9.28e-06 ***
b78         -52.128201   9.370665  -5.563 2.67e-08 ***
b79          56.747815  12.994458   4.367 1.26e-05 ***
b80         -53.143091   9.370635  -5.671 1.43e-08 ***
b81          57.541493  13.004685   4.425 9.68e-06 ***
b82         -53.994225   9.381919  -5.755 8.71e-09 ***
b83          57.687435  13.010975   4.434 9.28e-06 ***
b84         -52.643628   9.381941  -5.611 2.02e-08 ***
b85          58.100196  13.004732   4.468 7.93e-06 ***
b86         -49.772597   9.370665  -5.312 1.09e-07 ***
b87          57.336820  12.994462   4.412 1.02e-05 ***
b88         -53.340970   9.370641  -5.692 1.26e-08 ***
b89          60.916544  13.004695   4.684 2.82e-06 ***
b90         -55.443026   9.381925  -5.910 3.45e-09 ***
b91          52.942202  13.010978   4.069 4.73e-05 ***
b92         -51.173110   9.381941  -5.454 4.94e-08 ***
b93          54.916705  13.004729   4.223 2.42e-05 ***
b94         -52.483933   9.370664  -5.601 2.14e-08 ***
b95          56.062252  12.994465   4.314 1.60e-05 ***
b96         -53.340324   9.370647  -5.692 1.26e-08 ***
b97          59.317157  13.004704   4.561 5.10e-06 ***
b98         -53.124266   9.381929  -5.662 1.50e-08 ***
b99          56.945035  13.010981   4.377 1.21e-05 ***
b100        -51.202930   9.381940  -5.458 4.85e-08 ***
b101         54.955154  13.004724   4.226 2.39e-05 ***
b102        -52.261242   9.370663  -5.577 2.46e-08 ***
b103         55.037888  12.994466   4.235 2.28e-05 ***
b104        -53.142075   9.370651  -5.671 1.43e-08 ***
b105         57.543649  13.004709   4.425 9.67e-06 ***
b106        -52.951260   9.381930  -5.644 1.67e-08 ***
b107         59.904688  13.010971   4.604 4.15e-06 ***
b108        -53.624259   9.381936  -5.716 1.10e-08 ***
b109         55.310372  13.004796   4.253 2.11e-05 ***
b110        -52.717881   9.370686  -5.626 1.86e-08 ***
b111         57.447627  12.994504   4.421 9.85e-06 ***
b112        -52.121066   9.370710  -5.562 2.68e-08 ***
b113         57.135981  13.004990   4.393 1.12e-05 ***
b114        -52.859971   9.382794  -5.634 1.77e-08 ***
b115         57.049015  13.011108   4.385 1.16e-05 ***
b116        -51.395549   9.381963  -5.478 4.32e-08 ***
b117         55.381347  13.004728   4.259 2.06e-05 ***
b118        -50.187365   9.370660  -5.356 8.56e-08 ***
b119         54.296489  12.994470   4.178 2.94e-05 ***
b120        -48.966962   9.370660  -5.226 1.74e-07 ***
b121         58.634685  13.004724   4.509 6.54e-06 ***
b122        -51.173563   9.381939  -5.454 4.94e-08 ***
b123         56.893332  13.010981   4.373 1.23e-05 ***
b124        -53.157135   9.381935  -5.666 1.47e-08 ***
b125         59.960833  13.004705   4.611 4.02e-06 ***
b126        -53.992771   9.370666  -5.762 8.37e-09 ***
b127         59.502930  12.994493   4.579 4.68e-06 ***
b128        -52.503321   9.370669  -5.603 2.12e-08 ***
b129         61.039923  13.004748   4.694 2.69e-06 ***
b130        -52.248493   9.381986  -5.569 2.58e-08 ***
b131         59.259042  13.011244   4.554 5.27e-06 ***
b132        -54.301010   9.381965  -5.788 7.18e-09 ***
b133         59.007483  13.004710   4.537 5.71e-06 ***
b134        -50.464326   9.370652  -5.385 7.26e-08 ***
b135         55.570225  12.994465   4.276 1.90e-05 ***
b136        -53.329517   9.370664  -5.691 1.27e-08 ***
b137         59.062873  13.004732   4.542 5.60e-06 ***
b138        -52.474163   9.381941  -5.593 2.24e-08 ***
b139         60.084847  13.010975   4.618 3.88e-06 ***
b140        -54.965522   9.381926  -5.859 4.70e-09 ***
b141         56.946456  13.004686   4.379 1.20e-05 ***
b142        -50.395905   9.370643  -5.378 7.56e-08 ***
b143         57.007714  12.994459   4.387 1.15e-05 ***
b144        -51.026429   9.370665  -5.445 5.20e-08 ***
b145         56.412118  13.004733   4.338 1.44e-05 ***
b146        -50.705105   9.381941  -5.405 6.53e-08 ***
b147         58.085017  13.010971   4.464 8.05e-06 ***
b148        -53.158763   9.381921  -5.666 1.47e-08 ***
b149         56.699972  13.004675   4.360 1.30e-05 ***
b150        -52.081455   9.370637  -5.558 2.74e-08 ***
b151         59.313917  12.994454   4.565 5.02e-06 ***
b152        -53.401983   9.370665  -5.699 1.21e-08 ***
b153         58.054455  13.004734   4.464 8.06e-06 ***
b154        -53.123060   9.381940  -5.662 1.50e-08 ***
b155         59.279258  13.010965   4.556 5.22e-06 ***
b156        -52.457957   9.381916  -5.591 2.26e-08 ***
b157         57.411671  13.004663   4.415 1.01e-05 ***
b158        -52.733734   9.370630  -5.628 1.84e-08 ***
b159         58.202514  12.994448   4.479 7.52e-06 ***
b160        -51.660642   9.370665  -5.513 3.55e-08 ***
b161         58.051937  13.004734   4.464 8.07e-06 ***
b162        -52.284222   9.381939  -5.573 2.52e-08 ***
b163         56.373479  13.010959   4.333 1.48e-05 ***
b164        -50.572936   9.381909  -5.390 7.06e-08 ***
b165         54.855264  13.004650   4.218 2.47e-05 ***
b166        -49.909768   9.370623  -5.326 1.01e-07 ***
b167         55.803873  12.994440   4.294 1.75e-05 ***
b168        -53.118945   9.370664  -5.669 1.45e-08 ***
b169         59.481585  13.004733   4.574 4.80e-06 ***
b170        -51.299194   9.381937  -5.468 4.58e-08 ***
b171         57.303745  13.010951   4.404 1.06e-05 ***
b172        -53.203433   9.381902  -5.671 1.43e-08 ***
b173         60.152326  13.004635   4.625 3.75e-06 ***
b174        -52.475638   9.370614  -5.600 2.15e-08 ***
b175         59.270895  12.994432   4.561 5.10e-06 ***
b176        -55.262196   9.370662  -5.897 3.72e-09 ***
b177         60.056895  13.004730   4.618 3.88e-06 ***
b178        -53.217947   9.381934  -5.672 1.42e-08 ***
b179         57.439155  13.010942   4.415 1.01e-05 ***
b180        -52.583318   9.381894  -5.605 2.10e-08 ***
b181         58.696870  13.004620   4.514 6.39e-06 ***
b182        -52.373134   9.370605  -5.589 2.29e-08 ***
b183         60.582212  12.994422   4.662 3.14e-06 ***
b184        -55.769927   9.370660  -5.952 2.67e-09 ***
b185         60.624014  13.004727   4.662 3.14e-06 ***
b186        -53.592605   9.381930  -5.712 1.12e-08 ***
b187         57.539440  13.010931   4.422 9.78e-06 ***
b188        -51.817197   9.381885  -5.523 3.35e-08 ***
b189         59.964495  13.004603   4.611 4.02e-06 ***
b190        -52.166279   9.370595  -5.567 2.61e-08 ***
b191         57.464889  12.994412   4.422 9.79e-06 ***
b192        -51.557181   9.370657  -5.502 3.77e-08 ***
b193         58.740390  13.004722   4.517 6.29e-06 ***
b194        -53.170471   9.381926  -5.667 1.46e-08 ***
b195         60.735109  13.010920   4.668 3.05e-06 ***
b196        -55.079614   9.381875  -5.871 4.36e-09 ***
b197         62.290281  13.004585   4.790 1.67e-06 ***
b198        -53.937164   9.370585  -5.756 8.66e-09 ***
b199         60.692179  12.994400   4.671 3.01e-06 ***
b200        -53.199355   9.370653  -5.677 1.38e-08 ***
b201         59.751691  13.004716   4.595 4.35e-06 ***
b202        -53.973614   9.381921  -5.753 8.82e-09 ***
b203         60.208378  13.010908   4.628 3.71e-06 ***
b204        -53.240198   9.381865  -5.675 1.40e-08 ***
b205         61.874671  13.004566   4.758 1.96e-06 ***
b206        -52.062124   9.370574  -5.556 2.78e-08 ***
b207         57.123325  12.994387   4.396 1.10e-05 ***
b208        -53.151752   9.370648  -5.672 1.42e-08 ***
b209         58.631307  13.004709   4.508 6.55e-06 ***
b210        -52.866050   9.381915  -5.635 1.76e-08 ***
b211         56.113518  13.010894   4.313 1.62e-05 ***
b212        -50.737850   9.381854  -5.408 6.40e-08 ***
b213         60.815339  13.004546   4.676 2.93e-06 ***
b214        -53.231606   9.370562  -5.681 1.35e-08 ***
b215         57.347095  12.994373   4.413 1.02e-05 ***
b216        -51.192201   9.370643  -5.463 4.70e-08 ***
b217         58.601972  13.004701   4.506 6.61e-06 ***
b218        -53.861513   9.381909  -5.741 9.47e-09 ***
b219         63.108689  13.010879   4.850 1.24e-06 ***
b220        -52.220038   9.381842  -5.566 2.62e-08 ***
b221         61.528754  13.004525   4.731 2.24e-06 ***
b222        -51.010632   9.370549  -5.444 5.24e-08 ***
b223         60.841573  12.994357   4.682 2.85e-06 ***
b224        -53.565239   9.370636  -5.716 1.10e-08 ***
b225         58.773770  13.004691   4.519 6.22e-06 ***
b226        -48.926108   9.381901  -5.215 1.85e-07 ***
b227         60.740429  13.010863   4.668 3.04e-06 ***
b228        -52.181595   9.381830  -5.562 2.68e-08 ***
b229         57.256636  13.004503   4.403 1.07e-05 ***
b230        -50.786390   9.370535  -5.420 6.00e-08 ***
b231         58.732768  12.994341   4.520 6.20e-06 ***
b232        -51.934506   9.370629  -5.542 3.00e-08 ***
b233         58.683041  13.004681   4.512 6.42e-06 ***
b234        -49.919798   9.381893  -5.321 1.04e-07 ***
b235         60.867093  13.010846   4.678 2.90e-06 ***
b236        -51.586052   9.381817  -5.499 3.85e-08 ***
b237         59.789713  13.004479   4.598 4.28e-06 ***
b238        -51.649239   9.370521  -5.512 3.57e-08 ***
b239         59.980155  12.994324   4.616 3.92e-06 ***
b240        -53.642763   9.370622  -5.725 1.04e-08 ***
b241         59.805776  13.004669   4.599 4.26e-06 ***
b242        -53.914793   9.381884  -5.747 9.16e-09 ***
b243         64.849025  13.010828   4.984 6.24e-07 ***
b244        -53.436460   9.381803  -5.696 1.24e-08 ***
b245         60.015645  13.004454   4.615 3.94e-06 ***
b246        -50.342061   9.370506  -5.372 7.81e-08 ***
b247         62.966714  12.994305   4.846 1.27e-06 ***
b248        -51.729899   9.370613  -5.520 3.40e-08 ***
b249         60.317173  13.004656   4.638 3.53e-06 ***
b250        -52.444172   9.381874  -5.590 2.28e-08 ***
b251         56.864717  13.010808   4.371 1.24e-05 ***
b252        -50.499892   9.381786  -5.383 7.37e-08 ***
b253         55.594587  13.004422   4.275 1.91e-05 ***
b254        -47.857057   9.370481  -5.107 3.28e-07 ***
b255         59.168430  12.994249   4.553 5.29e-06 ***
b256        -49.996293   9.370558  -5.335 9.57e-08 ***
b257         60.033278  13.004461   4.616 3.92e-06 ***
b258        -51.969040   9.381717  -5.539 3.05e-08 ***
b259         60.366743  13.012348   4.639 3.51e-06 ***
b260        -51.825023   9.382147  -5.524 3.33e-08 ***
b261         57.712019  13.001822   4.439 9.07e-06 ***
b262        -52.660484   9.368981  -5.621 1.91e-08 ***
b263         63.056728  12.984583   4.856 1.20e-06 ***
b264        -51.748595   9.370934  -5.522 3.36e-08 ***
b265         61.531635  12.997984   4.734 2.21e-06 ***
b266        -50.631475   9.389947  -5.392 7.00e-08 ***
b267         59.928376  12.983653   4.616 3.93e-06 ***
b268        -51.228518   9.435291  -5.429 5.68e-08 ***
b269         63.167655  12.836606   4.921 8.64e-07 ***
b270         -9.069099   8.658117  -1.047 0.294889    
b271                NA         NA      NA       NA    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 4.718 on 48381 degrees of freedom
  (478 observations deleted due to missingness)
Multiple R-squared:  0.853,	Adjusted R-squared:  0.8521 
F-statistic: 955.2 on 294 and 48381 DF,  p-value: < 2.2e-16

> # Toronto
> summary(lms[[3]])

Call:
lm(formula = "mean_temp~.", data = data[row_ids[, k], x_cols])

Residuals:
     Min       1Q   Median       3Q      Max 
-20.2048  -2.6939   0.0044   2.7858  16.2228 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  1.253e+01  3.048e+00   4.112 3.93e-05 ***
s1           4.530e+00  1.785e+00   2.538 0.011156 *  
s2          -1.075e-01  2.402e-02  -4.474 7.70e-06 ***
s3           5.179e-02  6.213e-02   0.834 0.404524    
s4           9.213e-02  2.400e-02   3.839 0.000124 ***
s5           1.995e-01  2.557e-02   7.801 6.22e-15 ***
s6           9.882e-02  2.399e-02   4.118 3.82e-05 ***
s7           2.708e-02  2.404e-02   1.127 0.259941    
s8           8.422e-02  2.399e-02   3.510 0.000448 ***
s9           3.009e-02  2.399e-02   1.254 0.209855    
s10         -3.468e-02  2.399e-02  -1.445 0.148334    
s11         -3.492e-02  2.400e-02  -1.455 0.145700    
s12         -3.674e-02  2.399e-02  -1.531 0.125670    
c1          -1.043e+01  3.312e-01 -31.502  < 2e-16 ***
c2           9.889e-03  2.405e-02   0.411 0.680935    
c3           3.026e-01  4.245e-02   7.129 1.02e-12 ***
c4           2.798e-02  2.400e-02   1.166 0.243681    
c5          -6.461e-02  2.661e-02  -2.428 0.015180 *  
c6           1.663e-01  2.399e-02   6.932 4.18e-12 ***
c7           7.788e-02  2.452e-02   3.176 0.001493 ** 
c8          -2.414e-02  2.399e-02  -1.006 0.314469    
c9           1.243e-02  2.412e-02   0.515 0.606383    
c10          1.061e-02  2.399e-02   0.442 0.658219    
c11         -7.151e-02  2.403e-02  -2.976 0.002919 ** 
c12          1.663e-02  2.399e-02   0.693 0.488305    
b1          -2.348e+01  4.533e+00  -5.180 2.23e-07 ***
b2           1.246e+01  4.972e+00   2.506 0.012212 *  
b3          -2.467e+01  4.236e+00  -5.823 5.79e-09 ***
b4           1.322e+01  5.114e+00   2.585 0.009740 ** 
b5          -2.236e+01  4.190e+00  -5.338 9.45e-08 ***
b6           1.197e+01  5.139e+00   2.330 0.019811 *  
b7          -2.558e+01  4.179e+00  -6.122 9.31e-10 ***
b8           1.247e+01  5.135e+00   2.428 0.015174 *  
b9          -2.214e+01  4.173e+00  -5.305 1.13e-07 ***
b10          1.211e+01  5.136e+00   2.357 0.018402 *  
b11         -2.223e+01  4.176e+00  -5.323 1.02e-07 ***
b12          1.124e+01  5.144e+00   2.185 0.028917 *  
b13         -2.398e+01  4.179e+00  -5.738 9.64e-09 ***
b14          1.540e+01  5.144e+00   2.993 0.002765 ** 
b15         -2.633e+01  4.177e+00  -6.304 2.92e-10 ***
b16          1.292e+01  5.136e+00   2.515 0.011904 *  
b17         -2.336e+01  4.172e+00  -5.598 2.18e-08 ***
b18          1.214e+01  5.136e+00   2.364 0.018058 *  
b19         -2.579e+01  4.176e+00  -6.175 6.64e-10 ***
b20          1.374e+01  5.144e+00   2.671 0.007565 ** 
b21         -2.370e+01  4.179e+00  -5.672 1.42e-08 ***
b22          1.192e+01  5.144e+00   2.317 0.020493 *  
b23         -2.347e+01  4.177e+00  -5.620 1.92e-08 ***
b24          1.170e+01  5.136e+00   2.278 0.022742 *  
b25         -2.683e+01  4.172e+00  -6.432 1.27e-10 ***
b26          1.372e+01  5.136e+00   2.672 0.007543 ** 
b27         -2.469e+01  4.176e+00  -5.912 3.41e-09 ***
b28          1.333e+01  5.144e+00   2.592 0.009557 ** 
b29         -2.604e+01  4.179e+00  -6.230 4.69e-10 ***
b30          1.516e+01  5.144e+00   2.948 0.003202 ** 
b31         -2.650e+01  4.177e+00  -6.346 2.23e-10 ***
b32          1.405e+01  5.136e+00   2.736 0.006227 ** 
b33         -2.847e+01  4.172e+00  -6.825 8.90e-12 ***
b34          1.431e+01  5.136e+00   2.786 0.005337 ** 
b35         -2.835e+01  4.176e+00  -6.788 1.15e-11 ***
b36          1.402e+01  5.144e+00   2.725 0.006430 ** 
b37         -2.466e+01  4.179e+00  -5.900 3.65e-09 ***
b38          1.351e+01  5.144e+00   2.627 0.008619 ** 
b39         -2.249e+01  4.177e+00  -5.384 7.30e-08 ***
b40          1.122e+01  5.136e+00   2.185 0.028893 *  
b41         -2.340e+01  4.172e+00  -5.609 2.05e-08 ***
b42          1.294e+01  5.136e+00   2.519 0.011771 *  
b43         -2.574e+01  4.176e+00  -6.162 7.22e-10 ***
b44          1.429e+01  5.144e+00   2.778 0.005464 ** 
b45         -2.528e+01  4.179e+00  -6.049 1.47e-09 ***
b46          1.407e+01  5.144e+00   2.735 0.006245 ** 
b47         -2.395e+01  4.177e+00  -5.734 9.88e-09 ***
b48          1.285e+01  5.136e+00   2.502 0.012335 *  
b49         -2.339e+01  4.172e+00  -5.605 2.09e-08 ***
b50          1.340e+01  5.136e+00   2.609 0.009074 ** 
b51         -2.499e+01  4.176e+00  -5.984 2.18e-09 ***
b52          1.499e+01  5.144e+00   2.913 0.003578 ** 
b53         -2.572e+01  4.179e+00  -6.155 7.55e-10 ***
b54          1.381e+01  5.144e+00   2.684 0.007286 ** 
b55         -2.547e+01  4.177e+00  -6.098 1.08e-09 ***
b56          1.466e+01  5.136e+00   2.854 0.004320 ** 
b57         -2.650e+01  4.172e+00  -6.351 2.15e-10 ***
b58          1.503e+01  5.136e+00   2.926 0.003439 ** 
b59         -2.603e+01  4.177e+00  -6.233 4.61e-10 ***
b60          1.230e+01  5.144e+00   2.391 0.016811 *  
b61         -2.324e+01  4.179e+00  -5.560 2.70e-08 ***
b62          1.460e+01  5.144e+00   2.837 0.004550 ** 
b63         -2.349e+01  4.177e+00  -5.623 1.88e-08 ***
b64          1.261e+01  5.136e+00   2.455 0.014108 *  
b65         -2.651e+01  4.172e+00  -6.354 2.11e-10 ***
b66          1.443e+01  5.136e+00   2.810 0.004959 ** 
b67         -2.803e+01  4.177e+00  -6.710 1.96e-11 ***
b68          1.439e+01  5.144e+00   2.798 0.005150 ** 
b69         -2.661e+01  4.179e+00  -6.368 1.93e-10 ***
b70          1.512e+01  5.145e+00   2.939 0.003294 ** 
b71         -2.931e+01  4.177e+00  -7.017 2.29e-12 ***
b72          1.358e+01  5.136e+00   2.645 0.008179 ** 
b73         -2.438e+01  4.172e+00  -5.843 5.16e-09 ***
b74          1.277e+01  5.136e+00   2.487 0.012883 *  
b75         -2.586e+01  4.177e+00  -6.192 5.97e-10 ***
b76          1.565e+01  5.144e+00   3.042 0.002351 ** 
b77         -2.154e+01  4.179e+00  -5.154 2.55e-07 ***
b78          1.433e+01  5.145e+00   2.785 0.005358 ** 
b79         -2.645e+01  4.177e+00  -6.333 2.42e-10 ***
b80          1.445e+01  5.136e+00   2.813 0.004905 ** 
b81         -2.192e+01  4.172e+00  -5.253 1.50e-07 ***
b82          1.239e+01  5.136e+00   2.412 0.015867 *  
b83         -2.718e+01  4.177e+00  -6.507 7.75e-11 ***
b84          1.823e+01  5.144e+00   3.544 0.000394 ***
b85         -2.525e+01  4.179e+00  -6.043 1.53e-09 ***
b86          1.490e+01  5.145e+00   2.895 0.003788 ** 
b87         -2.784e+01  4.177e+00  -6.666 2.65e-11 ***
b88          1.295e+01  5.136e+00   2.522 0.011666 *  
b89         -2.616e+01  4.172e+00  -6.269 3.67e-10 ***
b90          1.497e+01  5.136e+00   2.915 0.003559 ** 
b91         -3.017e+01  4.177e+00  -7.223 5.16e-13 ***
b92          1.440e+01  5.144e+00   2.799 0.005134 ** 
b93         -2.510e+01  4.179e+00  -6.006 1.91e-09 ***
b94          1.293e+01  5.145e+00   2.513 0.011962 *  
b95         -2.549e+01  4.177e+00  -6.103 1.05e-09 ***
b96          1.444e+01  5.136e+00   2.811 0.004938 ** 
b97         -2.787e+01  4.172e+00  -6.680 2.42e-11 ***
b98          1.429e+01  5.136e+00   2.781 0.005415 ** 
b99         -2.413e+01  4.177e+00  -5.778 7.62e-09 ***
b100         1.369e+01  5.144e+00   2.662 0.007778 ** 
b101        -2.237e+01  4.179e+00  -5.354 8.65e-08 ***
b102         1.226e+01  5.145e+00   2.383 0.017172 *  
b103        -2.383e+01  4.177e+00  -5.705 1.17e-08 ***
b104         1.404e+01  5.136e+00   2.734 0.006266 ** 
b105        -2.440e+01  4.172e+00  -5.848 5.00e-09 ***
b106         1.390e+01  5.136e+00   2.707 0.006795 ** 
b107        -2.647e+01  4.177e+00  -6.338 2.35e-10 ***
b108         1.446e+01  5.144e+00   2.810 0.004950 ** 
b109        -2.340e+01  4.179e+00  -5.600 2.15e-08 ***
b110         1.446e+01  5.145e+00   2.812 0.004932 ** 
b111        -2.501e+01  4.177e+00  -5.988 2.13e-09 ***
b112         1.341e+01  5.136e+00   2.612 0.009014 ** 
b113        -2.375e+01  4.173e+00  -5.693 1.26e-08 ***
b114         1.419e+01  5.136e+00   2.762 0.005738 ** 
b115        -2.391e+01  4.177e+00  -5.724 1.05e-08 ***
b116         1.443e+01  5.145e+00   2.804 0.005045 ** 
b117        -2.228e+01  4.180e+00  -5.330 9.87e-08 ***
b118         1.536e+01  5.147e+00   2.984 0.002845 ** 
b119        -2.528e+01  4.181e+00  -6.048 1.48e-09 ***
b120         1.606e+01  5.147e+00   3.121 0.001805 ** 
b121        -2.559e+01  4.181e+00  -6.122 9.32e-10 ***
b122         1.740e+01  5.147e+00   3.381 0.000723 ***
b123        -2.470e+01  4.181e+00  -5.908 3.49e-09 ***
b124         1.514e+01  5.147e+00   2.941 0.003272 ** 
b125        -2.361e+01  4.180e+00  -5.648 1.63e-08 ***
b126         1.317e+01  5.145e+00   2.559 0.010501 *  
b127        -2.110e+01  4.177e+00  -5.051 4.40e-07 ***
b128         1.241e+01  5.136e+00   2.415 0.015723 *  
b129        -2.613e+01  4.173e+00  -6.261 3.84e-10 ***
b130         1.340e+01  5.136e+00   2.609 0.009082 ** 
b131        -2.614e+01  4.177e+00  -6.257 3.95e-10 ***
b132         1.571e+01  5.145e+00   3.053 0.002264 ** 
b133        -2.353e+01  4.179e+00  -5.631 1.80e-08 ***
b134         1.569e+01  5.145e+00   3.050 0.002288 ** 
b135        -2.609e+01  4.177e+00  -6.247 4.20e-10 ***
b136         1.413e+01  5.136e+00   2.750 0.005952 ** 
b137        -2.423e+01  4.173e+00  -5.806 6.42e-09 ***
b138         1.588e+01  5.136e+00   3.091 0.001998 ** 
b139        -2.321e+01  4.177e+00  -5.556 2.78e-08 ***
b140         1.330e+01  5.145e+00   2.586 0.009720 ** 
b141        -2.143e+01  4.179e+00  -5.128 2.94e-07 ***
b142         1.290e+01  5.145e+00   2.507 0.012170 *  
b143        -2.237e+01  4.177e+00  -5.356 8.55e-08 ***
b144         1.533e+01  5.136e+00   2.985 0.002841 ** 
b145        -2.681e+01  4.173e+00  -6.424 1.34e-10 ***
b146         1.603e+01  5.136e+00   3.120 0.001807 ** 
b147        -2.266e+01  4.177e+00  -5.426 5.80e-08 ***
b148         1.538e+01  5.145e+00   2.988 0.002805 ** 
b149        -2.389e+01  4.179e+00  -5.716 1.10e-08 ***
b150         1.534e+01  5.145e+00   2.981 0.002876 ** 
b151        -2.381e+01  4.177e+00  -5.699 1.21e-08 ***
b152         1.533e+01  5.136e+00   2.985 0.002833 ** 
b153        -2.452e+01  4.173e+00  -5.876 4.22e-09 ***
b154         1.594e+01  5.136e+00   3.103 0.001914 ** 
b155        -2.534e+01  4.177e+00  -6.067 1.31e-09 ***
b156         1.248e+01  5.145e+00   2.425 0.015316 *  
b157        -2.510e+01  4.179e+00  -6.005 1.92e-09 ***
b158         1.537e+01  5.145e+00   2.987 0.002819 ** 
b159        -2.090e+01  4.177e+00  -5.005 5.62e-07 ***
b160         1.501e+01  5.136e+00   2.923 0.003471 ** 
b161        -2.626e+01  4.173e+00  -6.293 3.13e-10 ***
b162         1.601e+01  5.136e+00   3.116 0.001832 ** 
b163        -1.992e+01  4.177e+00  -4.770 1.85e-06 ***
b164         1.544e+01  5.145e+00   3.001 0.002689 ** 
b165        -2.250e+01  4.179e+00  -5.384 7.30e-08 ***
b166         1.598e+01  5.145e+00   3.105 0.001903 ** 
b167        -2.598e+01  4.177e+00  -6.219 5.03e-10 ***
b168         1.569e+01  5.136e+00   3.055 0.002251 ** 
b169        -2.415e+01  4.173e+00  -5.787 7.18e-09 ***
b170         1.301e+01  5.136e+00   2.534 0.011287 *  
b171        -2.251e+01  4.177e+00  -5.389 7.13e-08 ***
b172         1.373e+01  5.145e+00   2.668 0.007628 ** 
b173        -2.558e+01  4.179e+00  -6.120 9.41e-10 ***
b174         1.343e+01  5.145e+00   2.610 0.009059 ** 
b175        -2.353e+01  4.177e+00  -5.634 1.77e-08 ***
b176         1.497e+01  5.136e+00   2.914 0.003570 ** 
b177        -2.355e+01  4.173e+00  -5.643 1.68e-08 ***
b178         1.436e+01  5.136e+00   2.796 0.005183 ** 
b179        -2.216e+01  4.177e+00  -5.306 1.12e-07 ***
b180         1.314e+01  5.145e+00   2.554 0.010645 *  
b181        -2.263e+01  4.179e+00  -5.416 6.13e-08 ***
b182         1.524e+01  5.145e+00   2.963 0.003052 ** 
b183        -2.311e+01  4.177e+00  -5.532 3.17e-08 ***
b184         1.777e+01  5.136e+00   3.461 0.000539 ***
b185        -2.193e+01  4.173e+00  -5.255 1.49e-07 ***
b186         1.374e+01  5.136e+00   2.675 0.007468 ** 
b187        -2.019e+01  4.177e+00  -4.834 1.34e-06 ***
b188         1.354e+01  5.145e+00   2.633 0.008475 ** 
b189        -2.535e+01  4.179e+00  -6.064 1.33e-09 ***
b190         1.568e+01  5.145e+00   3.047 0.002311 ** 
b191        -2.394e+01  4.177e+00  -5.732 9.98e-09 ***
b192         1.481e+01  5.136e+00   2.884 0.003930 ** 
b193        -2.449e+01  4.173e+00  -5.869 4.40e-09 ***
b194         1.554e+01  5.136e+00   3.026 0.002476 ** 
b195        -2.211e+01  4.177e+00  -5.294 1.20e-07 ***
b196         1.415e+01  5.145e+00   2.751 0.005948 ** 
b197        -2.234e+01  4.179e+00  -5.344 9.12e-08 ***
b198         1.613e+01  5.145e+00   3.136 0.001715 ** 
b199        -2.402e+01  4.177e+00  -5.752 8.86e-09 ***
b200         1.618e+01  5.136e+00   3.151 0.001628 ** 
b201        -2.544e+01  4.173e+00  -6.098 1.08e-09 ***
b202         1.478e+01  5.136e+00   2.877 0.004013 ** 
b203        -2.276e+01  4.177e+00  -5.450 5.05e-08 ***
b204         1.609e+01  5.145e+00   3.128 0.001762 ** 
b205        -2.165e+01  4.179e+00  -5.179 2.23e-07 ***
b206         1.455e+01  5.145e+00   2.828 0.004684 ** 
b207        -2.399e+01  4.177e+00  -5.743 9.37e-09 ***
b208         1.490e+01  5.136e+00   2.900 0.003729 ** 
b209        -2.278e+01  4.173e+00  -5.460 4.77e-08 ***
b210         1.512e+01  5.136e+00   2.943 0.003247 ** 
b211        -2.290e+01  4.177e+00  -5.482 4.23e-08 ***
b212         1.437e+01  5.145e+00   2.793 0.005219 ** 
b213        -2.237e+01  4.179e+00  -5.353 8.66e-08 ***
b214         1.599e+01  5.145e+00   3.109 0.001880 ** 
b215        -2.424e+01  4.177e+00  -5.803 6.56e-09 ***
b216         1.690e+01  5.136e+00   3.291 0.001000 ***
b217        -2.502e+01  4.173e+00  -5.996 2.04e-09 ***
b218         1.733e+01  5.136e+00   3.373 0.000743 ***
b219        -2.151e+01  4.177e+00  -5.149 2.62e-07 ***
b220         1.700e+01  5.145e+00   3.304 0.000953 ***
b221        -2.373e+01  4.179e+00  -5.678 1.37e-08 ***
b222         1.457e+01  5.145e+00   2.832 0.004621 ** 
b223        -2.087e+01  4.177e+00  -4.997 5.85e-07 ***
b224         1.413e+01  5.136e+00   2.750 0.005954 ** 
b225        -2.135e+01  4.173e+00  -5.116 3.13e-07 ***
b226         1.551e+01  5.136e+00   3.021 0.002524 ** 
b227        -2.067e+01  4.177e+00  -4.949 7.47e-07 ***
b228         1.599e+01  5.145e+00   3.109 0.001879 ** 
b229        -2.145e+01  4.179e+00  -5.133 2.86e-07 ***
b230         1.437e+01  5.145e+00   2.793 0.005227 ** 
b231        -2.060e+01  4.177e+00  -4.932 8.14e-07 ***
b232         1.670e+01  5.136e+00   3.252 0.001147 ** 
b233        -2.448e+01  4.173e+00  -5.867 4.47e-09 ***
b234         1.497e+01  5.136e+00   2.914 0.003571 ** 
b235        -2.150e+01  4.177e+00  -5.148 2.64e-07 ***
b236         1.506e+01  5.145e+00   2.926 0.003431 ** 
b237        -2.162e+01  4.179e+00  -5.172 2.32e-07 ***
b238         1.409e+01  5.145e+00   2.738 0.006179 ** 
b239        -2.341e+01  4.177e+00  -5.605 2.09e-08 ***
b240         1.793e+01  5.136e+00   3.490 0.000483 ***
b241        -2.463e+01  4.173e+00  -5.902 3.61e-09 ***
b242         1.684e+01  5.136e+00   3.278 0.001047 ** 
b243        -2.418e+01  4.177e+00  -5.789 7.10e-09 ***
b244         1.692e+01  5.145e+00   3.288 0.001009 ** 
b245        -2.273e+01  4.179e+00  -5.438 5.42e-08 ***
b246         1.542e+01  5.145e+00   2.997 0.002730 ** 
b247        -2.410e+01  4.177e+00  -5.769 8.01e-09 ***
b248         1.626e+01  5.136e+00   3.166 0.001545 ** 
b249        -2.219e+01  4.173e+00  -5.319 1.05e-07 ***
b250         1.511e+01  5.136e+00   2.942 0.003265 ** 
b251        -2.320e+01  4.177e+00  -5.553 2.81e-08 ***
b252         1.472e+01  5.145e+00   2.861 0.004222 ** 
b253        -2.233e+01  4.179e+00  -5.342 9.24e-08 ***
b254         1.539e+01  5.145e+00   2.991 0.002784 ** 
b255        -2.292e+01  4.177e+00  -5.487 4.11e-08 ***
b256         1.420e+01  5.136e+00   2.764 0.005711 ** 
b257        -2.285e+01  4.173e+00  -5.477 4.34e-08 ***
b258         1.566e+01  5.136e+00   3.050 0.002293 ** 
b259        -2.271e+01  4.177e+00  -5.438 5.41e-08 ***
b260         1.586e+01  5.145e+00   3.083 0.002050 ** 
b261        -2.427e+01  4.179e+00  -5.808 6.35e-09 ***
b262         1.779e+01  5.145e+00   3.457 0.000546 ***
b263        -2.510e+01  4.177e+00  -6.011 1.86e-09 ***
b264         1.822e+01  5.136e+00   3.548 0.000388 ***
b265        -2.408e+01  4.173e+00  -5.770 7.97e-09 ***
b266         1.531e+01  5.136e+00   2.981 0.002878 ** 
b267        -2.162e+01  4.177e+00  -5.176 2.28e-07 ***
b268         1.684e+01  5.145e+00   3.274 0.001061 ** 
b269        -2.299e+01  4.179e+00  -5.502 3.77e-08 ***
b270         1.517e+01  5.145e+00   2.949 0.003185 ** 
b271        -2.089e+01  4.177e+00  -5.002 5.69e-07 ***
b272         1.513e+01  5.136e+00   2.946 0.003225 ** 
b273        -2.005e+01  4.172e+00  -4.806 1.55e-06 ***
b274         1.203e+01  5.136e+00   2.343 0.019142 *  
b275        -2.161e+01  4.177e+00  -5.174 2.29e-07 ***
b276         1.581e+01  5.145e+00   3.072 0.002126 ** 
b277        -2.471e+01  4.179e+00  -5.912 3.39e-09 ***
b278         1.585e+01  5.145e+00   3.082 0.002059 ** 
b279        -2.383e+01  4.177e+00  -5.705 1.17e-08 ***
b280         1.497e+01  5.136e+00   2.914 0.003570 ** 
b281        -2.175e+01  4.172e+00  -5.212 1.87e-07 ***
b282         1.346e+01  5.136e+00   2.620 0.008788 ** 
b283        -2.168e+01  4.177e+00  -5.190 2.11e-07 ***
b284         1.453e+01  5.145e+00   2.824 0.004738 ** 
b285        -2.392e+01  4.179e+00  -5.723 1.05e-08 ***
b286         1.570e+01  5.145e+00   3.052 0.002277 ** 
b287        -2.081e+01  4.177e+00  -4.984 6.26e-07 ***
b288         1.529e+01  5.136e+00   2.976 0.002918 ** 
b289        -2.353e+01  4.172e+00  -5.640 1.70e-08 ***
b290         1.575e+01  5.136e+00   3.066 0.002169 ** 
b291        -2.151e+01  4.177e+00  -5.149 2.62e-07 ***
b292         1.429e+01  5.145e+00   2.778 0.005477 ** 
b293        -2.077e+01  4.179e+00  -4.970 6.71e-07 ***
b294         1.336e+01  5.145e+00   2.596 0.009422 ** 
b295        -1.864e+01  4.177e+00  -4.462 8.12e-06 ***
b296         1.447e+01  5.136e+00   2.818 0.004832 ** 
b297        -2.105e+01  4.172e+00  -5.044 4.56e-07 ***
b298         1.559e+01  5.136e+00   3.035 0.002408 ** 
b299        -2.176e+01  4.177e+00  -5.209 1.91e-07 ***
b300         1.443e+01  5.145e+00   2.805 0.005033 ** 
b301        -2.095e+01  4.179e+00  -5.013 5.38e-07 ***
b302         1.477e+01  5.145e+00   2.871 0.004098 ** 
b303        -1.918e+01  4.177e+00  -4.592 4.41e-06 ***
b304         1.577e+01  5.136e+00   3.070 0.002142 ** 
b305        -2.213e+01  4.172e+00  -5.304 1.14e-07 ***
b306         1.329e+01  5.136e+00   2.588 0.009649 ** 
b307        -2.139e+01  4.177e+00  -5.121 3.05e-07 ***
b308         1.459e+01  5.145e+00   2.836 0.004571 ** 
b309        -2.419e+01  4.179e+00  -5.789 7.11e-09 ***
b310         1.706e+01  5.144e+00   3.316 0.000915 ***
b311        -2.125e+01  4.177e+00  -5.089 3.62e-07 ***
b312         1.549e+01  5.136e+00   3.016 0.002563 ** 
b313        -2.425e+01  4.172e+00  -5.811 6.24e-09 ***
b314         1.614e+01  5.136e+00   3.142 0.001676 ** 
b315        -2.231e+01  4.177e+00  -5.341 9.28e-08 ***
b316         1.435e+01  5.145e+00   2.790 0.005278 ** 
b317        -1.794e+01  4.179e+00  -4.293 1.77e-05 ***
b318         1.575e+01  5.144e+00   3.062 0.002200 ** 
b319        -1.947e+01  4.177e+00  -4.661 3.16e-06 ***
b320         1.607e+01  5.136e+00   3.130 0.001750 ** 
b321        -1.982e+01  4.172e+00  -4.750 2.04e-06 ***
b322         1.417e+01  5.136e+00   2.760 0.005784 ** 
b323        -2.135e+01  4.175e+00  -5.114 3.16e-07 ***
b324         1.761e+01  5.141e+00   3.425 0.000615 ***
b325        -2.014e+01  4.173e+00  -4.827 1.39e-06 ***
b326         1.655e+01  5.130e+00   3.227 0.001253 ** 
b327        -2.430e+01  4.165e+00  -5.836 5.38e-09 ***
b328         1.757e+01  5.328e+00   3.298 0.000976 ***
b329         6.769e+02  2.464e+03   0.275 0.783523    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 4.143 on 59297 degrees of freedom
  (7401 observations deleted due to missingness)
Multiple R-squared:  0.841,	Adjusted R-squared:  0.8401 
F-statistic: 888.7 on 353 and 59297 DF,  p-value: < 2.2e-16

> 
> # register the results
> data <- data %>% mutate(mu = NA , ctemp = NA)
> for(k in 1:p){
+   data[non_na & row_ids[,k],] <- data[non_na & row_ids[,k],] %>% 
+     mutate(mu = lms[[k]]$fitted.values, ctemp = mean_temp - mu)
+ }
> 
> # remove b cols of data (for memory)
> data <- data %>% 
+   select(!any_of(b_cols[[which.max(sapply(b_cols, length))]])) %>%
+   select(!any_of(c(s_cols, c_cols)))
> gc()
            used   (Mb) gc trigger   (Mb)  max used   (Mb)
Ncells   2494698  133.3    4520295  241.5   4520295  241.5
Vcells 191985720 1464.8  615730557 4697.7 512975919 3913.7
> 
> # quick check
> data0 <- data %>% group_by(year, station_name) %>%
+   summarise(m_mt = mean(mean_temp, na.rm=T),
+             m_mu = mean(mu, na.rm=T))
`summarise()` has grouped output by 'year'. You can override using the
`.groups` argument.
> ggplot(data0, aes(x=year, y=m_mt, col=station_name, group=station_name)) +
+   theme_light() +
+   geom_line(data = data0, aes(y=m_mu), col=1) +
+   geom_point()
Warning messages:
1: Removed 20 row(s) containing missing values (geom_path). 
2: Removed 25 rows containing missing values (geom_point). 
> 
> data0 <- data %>% filter(year %in% 1950:1970) %>%
+   group_by(year, month, station_name) %>%
+   summarise(m_mt = mean(mean_temp, na.rm=T),
+             m_mu = mean(mu, na.rm=T))
`summarise()` has grouped output by 'year', 'month'. You can override using the
`.groups` argument.
> ggplot(data0, aes(x=year+month/12, y=m_mt, col=station_name, group=station_name)) +
+   geom_line() + geom_point() +
+   geom_line(data = data0, aes(y=m_mu)) +
+   facet_wrap(~station_name)
Warning messages:
1: Removed 21 row(s) containing missing values (geom_path). 
2: Removed 21 rows containing missing values (geom_point). 
3: Removed 21 row(s) containing missing values (geom_path). 
> 
> 
> # random check of the fits
> # some plots might show a break (when the data goes from Ottawa to Toronto)
> k <- sample(nrow(data),1)
> ii <- k + 1:365
> plot(data$time[ii], data$mean_temp[ii])
> lines(data$time[ii], data$mu[ii], col=2)
> 
> 
> # note that this breaks the equalities in the data
> # but there is still some heterogeneity in the variance
> N <- 20000 
> par(mfrow=c(p,2), mar=c(1,1,0,0))
> for(k in 1:p){
+   plot(data$yday[row_ids[,k]][1:N], data$mean_temp[row_ids[,k]][1:N], cex=.25)
+   plot(data$yday[row_ids[,k]][1:N], data$ctemp[row_ids[,k]][1:N], cex=.25)
+ }
> 
> 
> 
> # Compute pseudo-observations using ECDF ----------------------------------
> data <- data %>% mutate(pseudo_temp = NA, diff = NA, w1 = NA, w = NA)
> for(k in 1:p){
+   id <- stns_id[k]
+   cat("Working on ECDF for station ", id, ".\n")
+   row_id <- row_ids[,k]
+   
+   for(tt in 1:366){
+     if(tt %% 20 == 0) cat("progess: ", round(tt/366*100,2), "%\n")
+     
+     # construct weights based on yday using gaussian kernel
+     data[row_id,] <- data[row_id,] %>%
+       mutate(diff = tt - (time %% year_len)) %>%
+       mutate(diff = abs(pmin(diff, year_len - diff))) %>%
+       mutate(w1 = dnorm(diff,0,2)) %>%
+       mutate(w = w1/sum(w1, na.rm = T)) 
+     
+     # construct ecdf function using all the data
+     wecdf <- spatstat.geom::ewcdf(data[row_id,]$ctemp, data[row_id,]$w)
+     
+     # compute ecdf only for yday we care for
+     ind <- which(data[row_id,]$yday == tt & !is.na(data[row_id,]$ctemp))
+     data[row_id,][ind,] <- data[row_id,][ind,] %>%
+       mutate(pseudo_temp = wecdf(ctemp))
+     
+     # heuristic correction for the largest (pseudo_obs = 1)
+     # to avoid modifying all values (say, with pseudo_obs = pseudo_obs*n_ind/(n_ind+1))
+     n_ind <- length(ind)
+     data[row_id,][ind,] <- data[row_id,][ind,] %>%
+       mutate(pseudo_temp = ifelse(pseudo_temp == 1, 1-1/(2*n_ind), pseudo_temp))
+   }
+ }
Working on ECDF for station  568 .
progess:  5.46 %
progess:  10.93 %
progess:  16.39 %
progess:  21.86 %
progess:  27.32 %
progess:  32.79 %
progess:  38.25 %
progess:  43.72 %
progess:  49.18 %
progess:  54.64 %
progess:  60.11 %
progess:  65.57 %
progess:  71.04 %
progess:  76.5 %
progess:  81.97 %
progess:  87.43 %
progess:  92.9 %
progess:  98.36 %
Working on ECDF for station  4333 .
progess:  5.46 %
progess:  10.93 %
progess:  16.39 %
progess:  21.86 %
progess:  27.32 %
progess:  32.79 %
progess:  38.25 %
progess:  43.72 %
progess:  49.18 %
progess:  54.64 %
progess:  60.11 %
progess:  65.57 %
progess:  71.04 %
progess:  76.5 %
progess:  81.97 %
progess:  87.43 %
progess:  92.9 %
progess:  98.36 %
Working on ECDF for station  5051 .
progess:  5.46 %
progess:  10.93 %
progess:  16.39 %
progess:  21.86 %
progess:  27.32 %
progess:  32.79 %
progess:  38.25 %
progess:  43.72 %
progess:  49.18 %
progess:  54.64 %
progess:  60.11 %
progess:  65.57 %
progess:  71.04 %
progess:  76.5 %
progess:  81.97 %
progess:  87.43 %
progess:  92.9 %
progess:  98.36 %
> 
> 
> 
> # resulting histograms are even better than expected
> ggplot(data, aes(x = pseudo_temp, fill=as.factor(yday))) +
+   theme(legend.position = "none") +
+   geom_histogram(breaks=seq(0,1,.05), position = position_stack()) +
+   facet_wrap(~station_name)
Warning message:
Removed 12480 rows containing non-finite values (stat_bin). 
> 
> # quick check of the other operations (tt = 366, last it. of for loop)
> s <- sample(nrow(data) - 1000,1)
> par(mfrow=c(3,1))
> plot(data$pseudo_temp[s + 1:100], type="o") # makes sense
> plot(data$date[s + 1:1000], data$diff[s + 1:1000]) # linear in time, as expected
> plot(data$date[s + 1:1000], data$w[s + 1:1000], type="l") # select only end of year periods
> 
> # note that there are equalities, but very very few of them. can disregard.
> apply(row_ids, 2, \(r){
+   tab <- table(data[r,]$pseudo_temp)
+   tab[tab > 1]
+ })
[[1]]

0.110360254355897 0.201298996008785 0.309502126320153 0.995867768595041 
                2                 2                 2                 3 
0.995967741935484             0.996 
                3                 3 

[[2]]

0.411906779674204 0.428932367864423 0.615715057815527 0.718666628084974 
                2                 2                 2                 2 
0.996240601503759 0.996268656716418 
                6                 3 

[[3]]

0.119063877871665 0.639904042862563 0.843902166021178 0.996932515337423 
                2                 2                 2                 7 
0.996951219512195 
                4 

> 
> 
> 
> # Save for later use ------------------------------------------------------
> saveRDS(data, "app/data/data_pp2.rds")
> 
> proc.time()
    user   system  elapsed 
1562.052   14.128 1576.412 
